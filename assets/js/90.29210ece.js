(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{423:function(t,e,a){"use strict";a.r(e);var s=a(5),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"version-23-6"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#version-23-6"}},[t._v("#")]),t._v(" Version 23.6")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#introduction"}},[t._v("Introduction")])]),e("li",[e("a",{attrs:{href:"#what-to-know"}},[t._v("What to know")]),e("ul",[e("li",[e("a",{attrs:{href:"#remove-python-3-7-support"}},[t._v("Remove Python 3.7 support")])]),e("li",[e("a",{attrs:{href:"#resolve-pypy-compatibility-issues"}},[t._v("Resolve pypy compatibility issues")])]),e("li",[e("a",{attrs:{href:"#add-custom-typing-to-config-and-ctx-objects"}},[t._v("Add custom typing to config and ctx objects")])]),e("li",[e("a",{attrs:{href:"#universal-exception-signal"}},[t._v("Universal exception signal")])]),e("li",[e("a",{attrs:{href:"#add-name-prefixing-to-bp-groups"}},[t._v("Add name prefixing to BP groups")])]),e("li",[e("a",{attrs:{href:"#add-request-client-ip"}},[t._v("Add request.client_ip")])]),e("li",[e("a",{attrs:{href:"#increase-of-keep-alive-timeout-default-to-120-seconds"}},[t._v("Increase of KEEP_ALIVE_TIMEOUT default to 120 seconds")])]),e("li",[e("a",{attrs:{href:"#set-multiprocessing-start-method-early"}},[t._v("Set multiprocessing start method early")])])])]),e("li",[e("a",{attrs:{href:"#thank-you"}},[t._v("Thank you")])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),e("p",[t._v("This is the second release of the version 23 "),e("RouterLink",{attrs:{to:"/en/org/policies.html#release-schedule"}},[t._v("release cycle")]),t._v(". If you run into any issues, please raise a concern on "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/issues/new/choose",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),e("OutboundLink")],1),t._v(".")],1),t._v(" "),e("h2",{attrs:{id:"what-to-know"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#what-to-know"}},[t._v("#")]),t._v(" What to know")]),t._v(" "),e("p",[t._v("More details in the "),e("a",{attrs:{href:"https://sanic.readthedocs.io/en/stable/sanic/changelog.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Changelog"),e("OutboundLink")],1),t._v(". Notable new or breaking features, and what to upgrade...")]),t._v(" "),e("h3",{attrs:{id:"remove-python-3-7-support"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#remove-python-3-7-support"}},[t._v("#")]),t._v(" Remove Python 3.7 support")]),t._v(" "),e("p",[t._v("Python 3.7 is due to reach its scheduled upstream end-of-life on 2023-06-27. Sanic is now dropping support for Python 3.7, and requires Python 3.8 or newer.")]),t._v(" "),e("p",[t._v("See "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2777",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2777"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"resolve-pypy-compatibility-issues"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resolve-pypy-compatibility-issues"}},[t._v("#")]),t._v(" Resolve pypy compatibility issues")]),t._v(" "),e("p",[t._v("A small patch was added to the "),e("code",[t._v("os")]),t._v(" module to once again allow for Sanic to run with PyPy. This workaround replaces the missing "),e("code",[t._v("readlink")]),t._v(" function (missing in PyPy "),e("code",[t._v("os")]),t._v(" module) with the function "),e("code",[t._v("os.path.realpath")]),t._v(", which serves to the same purpose.")]),t._v(" "),e("p",[t._v("See "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2782",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2782"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"add-custom-typing-to-config-and-ctx-objects"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#add-custom-typing-to-config-and-ctx-objects"}},[t._v("#")]),t._v(" Add custom typing to config and ctx objects")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("sanic.Sanic")]),t._v(" and "),e("code",[t._v("sanic.Request")]),t._v(" object have become generic types that will make it more convenient to have fully typed "),e("code",[t._v("config")]),t._v(" and "),e("code",[t._v("ctx")]),t._v(" objects.")]),t._v(" "),e("p",[t._v("In the most simple form, the "),e("code",[t._v("Sanic")]),t._v(" object is typed as:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Sanic\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nreveal_type"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# N: Revealed type is "sanic.app.Sanic[sanic.config.Config, types.SimpleNamespace]"')]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),e("p",[t._v("It should be noted, there is "),e("em",[t._v("no")]),t._v(" requirement to use the generic types. The default types are "),e("code",[t._v("sanic.config.Config")]),t._v(" and "),e("code",[t._v("types.SimpleNamespace")]),t._v(". This new feature is just an option for those that want to use it and existing types of "),e("code",[t._v("app: Sanic")]),t._v(" and "),e("code",[t._v("request: Request")]),t._v(" should work just fine.")])]),t._v(" "),e("p",[t._v("Now it is possible to have a fully-type "),e("code",[t._v("app.config")]),t._v(", "),e("code",[t._v("app.ctx")]),t._v(", and "),e("code",[t._v("request.ctx")]),t._v(" objects though generics. This allows for better integration with auto completion tools in IDEs improving the developer experience.")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Sanic\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Config\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomConfig")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Foo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RequestContext")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    foo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Foo\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Sanic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("CustomConfig"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Foo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" RequestContext"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@staticmethod")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_context")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" RequestContext"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        ctx "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" RequestContext"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("foo "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Foo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ctx\n\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("CustomConfig"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Foo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request_class"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("CustomRequest\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CustomRequest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),e("p",[t._v("As a side effect, now "),e("code",[t._v("request.ctx")]),t._v(" is lazy initialized, which should reduce some overhead when the "),e("code",[t._v("request.ctx")]),t._v(" is unused.")]),t._v(" "),e("p",[t._v("One further change you may have noticed in the above snippet is the "),e("code",[t._v("make_context")]),t._v(" method. This new method can be used by custom "),e("code",[t._v("Request")]),t._v(" types to inject an object different from a "),e("code",[t._v("SimpleNamespace")]),t._v(" similar to how Sanic has allowed custom application context objects for a while.")]),t._v(" "),e("p",[t._v("For a more thorough discussion, see "),e("RouterLink",{attrs:{to:"/en/guide/basics/app.html#custom-typed-application"}},[t._v("custom typed application")]),t._v(" and "),e("RouterLink",{attrs:{to:"/en/guide/basics/app.html#custom-typed-request"}},[t._v("custom typed request")]),t._v(".")],1),t._v(" "),e("p",[t._v("See "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2785",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2785"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"universal-exception-signal"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#universal-exception-signal"}},[t._v("#")]),t._v(" Universal exception signal")]),t._v(" "),e("p",[t._v("A new exception signal added for "),e("strong",[t._v("ALL")]),t._v(" exceptions raised while the server is running: "),e("code",[t._v('"server.exception.reporting"')]),t._v(". This is a universal signal that will be emitted for any exception raised, and dispatched as its own task. This means that it will "),e("em",[t._v("not")]),t._v(" block the request handler, and will "),e("em",[t._v("not")]),t._v(" be affected by any middleware.")]),t._v(" "),e("p",[t._v("This is useful for catching exceptions that may occur outside of the request handler (for example in signals, or in a background task), and it intended for use to create a consistent error handling experience for the user.")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("signals "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Event\n\n"),e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("signal")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Event"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SERVER_LIFECYCLE_EXCEPTION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch_any_exception")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sanic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("my_error_reporter_utility"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("error"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("This pattern can be simplified with a new decorator "),e("code",[t._v("@app.report_exception")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("report_exception")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch_any_exception")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sanic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Caught exception:"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("It should be pointed out that this happens in a background task and is "),e("strong",[t._v("NOT")]),t._v(" for manipulation of an error response. It is only for reporting, logging, or other purposes that should be triggered when an application error occurs.")]),t._v(" "),e("p",[t._v("See "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2724",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2724"),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2792",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2792"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"add-name-prefixing-to-bp-groups"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#add-name-prefixing-to-bp-groups"}},[t._v("#")]),t._v(" Add name prefixing to BP groups")]),t._v(" "),e("p",[t._v("Sanic had been raising a warning on duplicate route names for a while, and started to enforce route name uniqueness in "),e("a",{attrs:{href:"https://sanic.dev/en/guide/release-notes/v23.3.html#deprecations-and-removals",target:"_blank",rel:"noopener noreferrer"}},[t._v("v23.3"),e("OutboundLink")],1),t._v(". This created a complication for blueprint composition.")]),t._v(" "),e("p",[t._v("New name prefixing parameter for blueprints groups has been added to alleviate this issue. It allows nesting of blueprints and groups to make them composable.")]),t._v(" "),e("p",[t._v("The addition is the new "),e("code",[t._v("name_prefix")]),t._v(" parameter as shown in this snippet.")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[t._v("bp1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Blueprint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bp1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url_prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bp1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nbp2 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Blueprint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bp2"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url_prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bp2"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nbp1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_route"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("_")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"route1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nbp2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_route"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("_")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"route2"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ngroup_a "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Blueprint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("group"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    bp1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bp2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url_prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/group-a"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name_prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"group-a"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ngroup_b "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Blueprint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("group"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    bp1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bp2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url_prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/group-b"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name_prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"group-b"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TestApp"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("blueprint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("group_a"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("blueprint"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("group_b"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("The routes built will be named as follows:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("TestApp.group-a_bp1.route1")])]),t._v(" "),e("li",[e("code",[t._v("TestApp.group-a_bp2.route2")])]),t._v(" "),e("li",[e("code",[t._v("TestApp.group-b_bp1.route1")])]),t._v(" "),e("li",[e("code",[t._v("TestApp.group-b_bp2.route2")])])]),t._v(" "),e("p",[t._v("See "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2727",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2727"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"add-request-client-ip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#add-request-client-ip"}},[t._v("#")]),t._v(" Add "),e("code",[t._v("request.client_ip")])]),t._v(" "),e("p",[t._v("Sanic has introduced "),e("code",[t._v("request.client_ip")]),t._v(", a new accessor that provides client's IP address from both local and proxy data. It allows running the application directly on Internet or behind a proxy. This is equivalent to "),e("code",[t._v("request.remote_addr or request.ip")]),t._v(", providing the client IP regardless of how the application is deployed.")]),t._v(" "),e("p",[t._v("See "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2790",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2790"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"increase-of-keep-alive-timeout-default-to-120-seconds"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#increase-of-keep-alive-timeout-default-to-120-seconds"}},[t._v("#")]),t._v(" Increase of "),e("code",[t._v("KEEP_ALIVE_TIMEOUT")]),t._v(" default to 120 seconds")]),t._v(" "),e("p",[t._v("The default "),e("code",[t._v("KEEP_ALIVE_TIMEOUT")]),t._v(" value changed from 5 seconds to 120 seconds. It is of course still configurable, but this change should improve performance on long latency connections, where reconnecting is expensive, and better fits typical user flow browsing pages with longer-than-5-second intervals.")]),t._v(" "),e("p",[t._v("Sanic has historically used 5 second timeouts to quickly close idle connections. The chosen value of "),e("strong",[t._v("120 seconds")]),t._v(" is indeed larger than Nginx default of 75, and is the same value that Caddy server has by default.")]),t._v(" "),e("p",[t._v("Related to "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/issues/2531",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2531"),e("OutboundLink")],1),t._v(" and\n"),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/issues/2681",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2681"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("See "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2670",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2670"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"set-multiprocessing-start-method-early"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#set-multiprocessing-start-method-early"}},[t._v("#")]),t._v(" Set multiprocessing start method early")]),t._v(" "),e("p",[t._v("Due to how Python handles "),e("code",[t._v("multiprocessing")]),t._v(", it may be confusing to some users how to properly create synchronization primitives. This is due to how Sanic creates the "),e("code",[t._v("multiprocessing")]),t._v(" context. This change sets the start method early so that any primitives created will properly attach to the correct context.")]),t._v(" "),e("p",[t._v("For most users, this should not be noticeable or impactful. But, it should make creation of something like this easier and work as expected.")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" multiprocessing "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Queue\n\n"),e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main_process_start")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("main_process_start")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shared_ctx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("queue "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Queue"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("See "),e("a",{attrs:{href:"https://github.com/sanic-org/sanic/pull/2776",target:"_blank",rel:"noopener noreferrer"}},[t._v("#2776"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"thank-you"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#thank-you"}},[t._v("#")]),t._v(" Thank you")]),t._v(" "),e("p",[t._v("Thank you to everyone that participated in this release: 👏")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/ahopkins",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ahopkins"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/ChihweiLHBird",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ChihweiLHBird"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/chuckds",target:"_blank",rel:"noopener noreferrer"}},[t._v("@chuckds"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/deounix",target:"_blank",rel:"noopener noreferrer"}},[t._v("@deounix"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/guacs",target:"_blank",rel:"noopener noreferrer"}},[t._v("@guacs"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/liamcoatman",target:"_blank",rel:"noopener noreferrer"}},[t._v("@liamcoatman"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/moshe742",target:"_blank",rel:"noopener noreferrer"}},[t._v("@moshe742"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/prryplatypus",target:"_blank",rel:"noopener noreferrer"}},[t._v("@prryplatypus"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/SaidBySolo",target:"_blank",rel:"noopener noreferrer"}},[t._v("@SaidBySolo"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/Thirumalai",target:"_blank",rel:"noopener noreferrer"}},[t._v("@Thirumalai"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/Tronic",target:"_blank",rel:"noopener noreferrer"}},[t._v("@Tronic"),e("OutboundLink")],1)]),t._v(" "),e("hr"),t._v(" "),e("p",[t._v("If you enjoy the project, please consider contributing. Of course we love code contributions, but we also love contributions in any form. Consider writing some documentation, showing off use cases, joining conversations and making your voice known, and if you are able: "),e("a",{attrs:{href:"https://opencollective.com/sanic-org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("financial contributions"),e("OutboundLink")],1),t._v(".")])])}),[],!1,null,null,null);e.default=n.exports}}]);