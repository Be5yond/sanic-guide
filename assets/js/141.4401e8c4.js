(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{459:function(t,a,s){"use strict";s.r(a);var e=s(4),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"構成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#構成"}},[t._v("#")]),t._v(" 構成")]),t._v(" "),a("h2",{attrs:{id:"ベーシック"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ベーシック"}},[t._v("#")]),t._v(" ベーシック")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("Sanicは、アプリケーションオブジェクトのconfig属性に設定を保持します。構成オブジェクトは、ドット表記法を使用して、または辞書のように変更できる単なるオブジェクトです。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myapp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DB_NAME "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"appdb"')]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DB_USER"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"appuser"')]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("また、通常の辞書と同様に"),a("code",[t._v("update()")]),t._v("メソッドを使用することもできます。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("db_settings "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DB_HOST'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DB_NAME'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'appdb'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DB_USER'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'appuser'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("db_settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Sanicでは、設定値には"),a("strong",[t._v("大文字で名前を付けるのが一般的です")]),t._v(".実際、大文字と小文字を混在させると奇妙な動作をすることがあります。")])]),t._v(" "),a("h2",{attrs:{id:"読み込み中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#読み込み中"}},[t._v("#")]),t._v(" 読み込み中")]),t._v(" "),a("h3",{attrs:{id:"環境変数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#環境変数"}},[t._v("#")]),t._v(" 環境変数")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[a("code",[t._v("SANIC_")]),t._v("プレフィックスで定義された環境変数は、Sanicの設定に適用されます。たとえば、設定"),a("code",[t._v("SANIC_REQUEST_TIMEOUT")]),t._v("はアプリケーションによって自動的にロードされ、"),a("code",[t._v("REQUEST_TIMEOUT")]),t._v("構成変数に渡されます。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("SANIC_REQUEST_TIMEOUT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REQUEST_TIMEOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("起動時にSanicが要求するプレフィクスを変更できます。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MYAPP_REQUEST_TIMEOUT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__name__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" load_env"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MYAPP_'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("REQUEST_TIMEOUT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("環境変数のロードを完全に無効にすることもできます。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__name__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" load_env"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"sanic-update-configを使用する"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sanic-update-configを使用する"}},[t._v("#")]),t._v(" Sanic.update_configを使用する")]),t._v(" "),a("p",[a("code",[t._v("Sanic")]),t._v("インスタンスには、config:"),a("code",[t._v("app.update_config")]),t._v("をロードするための_very_versatileメソッドがあります。ファイル、辞書、クラスなど、あらゆる種類のオブジェクトへのパスを指定できます。")]),t._v(" "),a("h4",{attrs:{id:"from-a-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#from-a-file"}},[t._v("#")]),t._v(" From a file")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("たとえば、次のような"),a("code",[t._v("my_config.py")]),t._v("ファイルがあるとします。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# my_config.py")]),t._v("\nA "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("パスを"),a("code",[t._v("app.update_config")]),t._v("に渡すことで、これを構成値としてロードできます。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/my_config.py"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("このパスはbashスタイルの環境変数も受け付けます。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("my_path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to"')]),t._v("\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${my_path}/my_config.py"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("環境変数は"),a("code",[t._v("${environment_variable}")]),t._v("の形式で指定する必要があり、"),a("code",[t._v("$environment_variable")]),t._v('は展開されません ("プレーン"テキストとして扱われます) 。')])]),t._v(" "),a("h4",{attrs:{id:"辞書から"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#辞書から"}},[t._v("#")]),t._v(" 辞書から")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[a("code",[t._v("app.update_config")]),t._v("メソッドは、通常の辞書でも動作します。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("h4",{attrs:{id:"クラスまたはオブジェクトから"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#クラスまたはオブジェクトから"}},[t._v("#")]),t._v(" クラスまたはオブジェクトから")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("独自の構成クラスを定義して、"),a("code",[t._v("app.update_config")])])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    A "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    B "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MyConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("インスタンス化も可能です。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update_config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MyConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"型キャスティング"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#型キャスティング"}},[t._v("#")]),t._v(" 型キャスティング")]),t._v(" "),a("p",[t._v("環境変数から読み込む場合、Sanicは値を期待されるPythonの型にキャストしようとします。これは特に以下に当てはまります。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("int")])]),t._v(" "),a("li",[a("code",[t._v("float")])]),t._v(" "),a("li",[a("code",[t._v("bool")])])]),t._v(" "),a("p",[a("code",[t._v("bool")]),t._v(" に関しては、以下のような大文字小文字を区別しない値を使用することができます。")]),t._v(" "),a("ul",[a("li",[a("strong",[a("code",[t._v("True")])]),t._v(": "),a("code",[t._v("y")]),t._v(", "),a("code",[t._v("yes")]),t._v(", "),a("code",[t._v("yep")]),t._v(", "),a("code",[t._v("yup")]),t._v(", "),a("code",[t._v("t")]),t._v(", "),a("code",[t._v("true")]),t._v(", "),a("code",[t._v("on")]),t._v(", "),a("code",[t._v("enable")]),t._v(", "),a("code",[t._v("enabled")]),t._v(", "),a("code",[t._v("1")])]),t._v(" "),a("li",[a("strong",[a("code",[t._v("False")])]),t._v(": "),a("code",[t._v("n")]),t._v(", "),a("code",[t._v("no")]),t._v(", "),a("code",[t._v("f")]),t._v(", "),a("code",[t._v("false")]),t._v(", "),a("code",[t._v("off")]),t._v(", "),a("code",[t._v("disable")]),t._v(", "),a("code",[t._v("disabled")]),t._v(", "),a("code",[t._v("0")])])]),t._v(" "),a("div",{staticClass:"custom-block new"},[a("p",{staticClass:"custom-block-title"},[t._v("NEW in v21.12")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[t._v("さらに、Sanicは追加のタイプコンバータを使用して、追加の型をキャストするように設定することができます。これは、値を返すか、"),a("code",[t._v("ValueError")]),t._v("を発生させる任意のcallableでなければならない。")])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("converters"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("UUID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])])]),t._v(" "),a("h2",{attrs:{id:"組み込み値"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#組み込み値"}},[t._v("#")]),t._v(" 組み込み値")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("変数")])]),t._v(" "),a("th",[a("strong",[t._v("デフォルト")])]),t._v(" "),a("th",[a("strong",[t._v("説明")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("ACCESS_LOG")]),t._v(" "),a("td",[t._v("True")]),t._v(" "),a("td",[t._v("アクセスログを無効または有効にする。")])]),t._v(" "),a("tr",[a("td",[t._v("AUTO_EXTEND ^")]),t._v(" "),a("td",[t._v("True")]),t._v(" "),a("td",[a("RouterLink",{attrs:{to:"/ja/plugins/sanic-ext/getting-started.html"}},[t._v("Sanic Extensions")]),t._v(" が既存の仮想環境内にある場合にロードするかどうかを制御する")],1)]),t._v(" "),a("tr",[a("td",[t._v("AUTO_RELOAD")]),t._v(" "),a("td",[t._v("True")]),t._v(" "),a("td",[t._v("ファイルが変更されたときにアプリケーションが自動的にリロードするかどうかを制御します。")])]),t._v(" "),a("tr",[a("td",[t._v("EVENT_AUTOREGISTER")]),t._v(" "),a("td",[t._v("True")]),t._v(" "),a("td",[a("code",[t._v("True")]),t._v(" のとき、存在しないシグナルに対して "),a("code",[t._v("app.event()")]),t._v(" メソッドを使用すると、自動的にシグナルを生成して例外を発生させないEVENT_AUTOREGISTER.index.index.")])]),t._v(" "),a("tr",[a("td",[t._v("FALLBACK_ERROR_FORMAT")]),t._v(" "),a("td",[t._v("html")]),t._v(" "),a("td",[t._v("例外が発生し処理されなかった場合のエラー応答のフォーマット")])]),t._v(" "),a("tr",[a("td",[t._v("FORWARDED_FOR_HEADER")]),t._v(" "),a("td",[t._v("X-Forwarded-For")]),t._v(" "),a("td",[t._v("クライアントとプロキシのIPを含む「X-Forwarded-For」HTTPヘッダの名前です。")])]),t._v(" "),a("tr",[a("td",[t._v("FORWARDED_SECRET")]),t._v(" "),a("td",[t._v("なし")]),t._v(" "),a("td",[t._v("特定のプロキシサーバーを安全に識別するために使用される（下記参照）")])]),t._v(" "),a("tr",[a("td",[t._v("GRACEFUL_SHUTDOWN_TIMEOUT")]),t._v(" "),a("td",[t._v("15.0")]),t._v(" "),a("td",[t._v("アイドルでない接続を強制終了するまでの時間(秒)")])]),t._v(" "),a("tr",[a("td",[t._v("KEEP_ALIVE")]),t._v(" "),a("td",[t._v("True")]),t._v(" "),a("td",[t._v("Falseの場合、キープアライブを無効にする。")])]),t._v(" "),a("tr",[a("td",[t._v("KEEP_ALIVE_TIMEOUT")]),t._v(" "),a("td",[t._v("5")]),t._v(" "),a("td",[t._v("TCP接続を開いたままにする時間(秒)")])]),t._v(" "),a("tr",[a("td",[t._v("MOTD ^")]),t._v(" "),a("td",[t._v("True")]),t._v(" "),a("td",[t._v("起動時にMOTD（今日のメッセージ）を表示するかどうか")])]),t._v(" "),a("tr",[a("td",[t._v("MOTD_DISPLAY ^")]),t._v(" "),a("td",[t._v("{}")]),t._v(" "),a("td",[t._v("MOTDに任意のデータを追加表示するためのキー/バリュー・ペア")])]),t._v(" "),a("tr",[a("td",[t._v("NOISY_EXCEPTIONS ^")]),t._v(" "),a("td",[t._v("False")]),t._v(" "),a("td",[t._v("すべての "),a("code",[t._v("quiet")]),t._v(" 例外を強制的にログに記録する")])]),t._v(" "),a("tr",[a("td",[t._v("PROXIES_COUNT")]),t._v(" "),a("td",[t._v("なし")]),t._v(" "),a("td",[t._v("アプリの前にあるプロキシサーバーの数(例：nginx)")])]),t._v(" "),a("tr",[a("td",[t._v("REAL_IP_HEADER")]),t._v(" "),a("td",[t._v("なし")]),t._v(" "),a("td",[t._v("本当のクライアントIPを含む「X-Real-IP」HTTPヘッダーの名前")])]),t._v(" "),a("tr",[a("td",[t._v("REGISTER")]),t._v(" "),a("td",[t._v("True")]),t._v(" "),a("td",[t._v("アプリのレジストリを有効にするかどうか。")])]),t._v(" "),a("tr",[a("td",[t._v("REQUEST_BUFFER_SIZE")]),t._v(" "),a("td",[t._v("65536")]),t._v(" "),a("td",[t._v("リクエストが一時停止するまでのリクエストバッファサイズ、デフォルトは64Kib")])]),t._v(" "),a("tr",[a("td",[t._v("REQUEST_ID_HEADER")]),t._v(" "),a("td",[t._v("X-Request-ID")]),t._v(" "),a("td",[t._v('リクエスト/相関 ID を含む HTTP ヘッダー "X-Request-ID" の名前')])]),t._v(" "),a("tr",[a("td",[t._v("REQUEST_MAX_SIZE")]),t._v(" "),a("td",[t._v("100000000")]),t._v(" "),a("td",[t._v("リクエストの大きさ (バイト)、デフォルトは100メガバイトです。")])]),t._v(" "),a("tr",[a("td",[t._v("REQUEST_TIMEOUT")]),t._v(" "),a("td",[t._v("60")]),t._v(" "),a("td",[t._v("リクエストが到着するまでの時間(秒)です。")])]),t._v(" "),a("tr",[a("td",[t._v("RESPONSE_TIMEOUT")]),t._v(" "),a("td",[t._v("60")]),t._v(" "),a("td",[t._v("レスポンス処理にかかる時間(秒)です。")])]),t._v(" "),a("tr",[a("td",[t._v("USE_UVLOOP")]),t._v(" "),a("td",[t._v("True")]),t._v(" "),a("td",[t._v("ループポリシーをオーバーライドして "),a("code",[t._v("uvloop")]),t._v(" を使用するかどうかを指定します。"),a("code",[t._v("app.run")]),t._v("でのみサポートされる。")])]),t._v(" "),a("tr",[a("td",[t._v("WEBSOCKET_MAX_SIZE")]),t._v(" "),a("td",[t._v("2^20")]),t._v(" "),a("td",[t._v("受信メッセージの最大サイズ (バイト)")])]),t._v(" "),a("tr",[a("td",[t._v("WEBSOCKET_PING_INTERVAL")]),t._v(" "),a("td",[t._v("20")]),t._v(" "),a("td",[t._v("Pingフレームはping_interval秒ごとに送信されます。")])]),t._v(" "),a("tr",[a("td",[t._v("WEBSOCKET_PING_TIMEOUT")]),t._v(" "),a("td",[t._v("20")]),t._v(" "),a("td",[t._v("ping_timeout秒後にPongを受信しない場合、接続を終了します。")])])])]),t._v(" "),a("div",{staticClass:"custom-block new"},[a("p",{staticClass:"custom-block-title"},[t._v("NEW in v21.12")]),t._v(" "),a("p",[t._v("新要素: "),a("code",[t._v("AUTO_EXTEND")]),t._v(", "),a("code",[t._v("MOTD")]),t._v(", "),a("code",[t._v("MOTD_DISPLAY")]),t._v(", "),a("code",[t._v("NOISY_EXCEPTIONS")])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("FYI")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("USE_UVLOOP")]),t._v(" の値は、Gunicorn で実行されている場合、無視されます。サポートされていないプラットフォーム (Windows) では、デフォルトは "),a("code",[t._v("False")]),t._v(" である。")]),t._v(" "),a("li",[t._v("ASGI モードでは "),a("code",[t._v("WEBSOCKET_")]),t._v(" 値は無視されます。")])])]),t._v(" "),a("h2",{attrs:{id:"タイムアウト"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#タイムアウト"}},[t._v("#")]),t._v(" タイムアウト")]),t._v(" "),a("h3",{attrs:{id:"リクエストタイムアウト"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#リクエストタイムアウト"}},[t._v("#")]),t._v(" リクエストタイムアウト")]),t._v(" "),a("p",[t._v("要求タイムアウトは、新しいオープンTCP接続がSanicバックエンドサーバーに渡された瞬間と、HTTP要求全体を受信した瞬間の間の時間を測定します。もし時間が "),a("code",[t._v("REQUEST_TIMEOUT")]),t._v(" 値（秒）を超えたら、これはクライアントエラーとみなされ、Sanicは "),a("code",[t._v("HTTP 408")]),t._v(" 応答を生成してクライアントに送信する。クライアントが日常的に非常に大きなリクエストペイロードを渡したり、リクエストを非常にゆっくりとアップロードする場合は、このパラメータの値を高く設定してください。")]),t._v(" "),a("h3",{attrs:{id:"応答タイムアウト"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#応答タイムアウト"}},[t._v("#")]),t._v(" 応答タイムアウト")]),t._v(" "),a("p",[t._v("レスポンスタイムアウトは、SanicサーバーがSanicアプリにHTTPリクエストを渡した瞬間から、HTTPレスポンスがクライアントに送信されるまでの時間を測定します。時間が "),a("code",[t._v("RESPONSE_TIMEOUT")]),t._v(" 値 (秒) を超えると、サーバーエラーと見なされるため、Sanic は "),a("code",[t._v("HTTP 503")]),t._v(" 応答を生成してクライアントに送信します。レスポンスの生成を遅らせるような長時間稼働のプロセスがあるようなアプリケーションでは、このパラメータの値を高く設定してください。")]),t._v(" "),a("h3",{attrs:{id:"キープアライブタイムアウト"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#キープアライブタイムアウト"}},[t._v("#")]),t._v(" キープアライブタイムアウト")]),t._v(" "),a("h4",{attrs:{id:"keep-alive-とは何ですか-また、キープアライブタイムアウトの値は何をするのでしょうか"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#keep-alive-とは何ですか-また、キープアライブタイムアウトの値は何をするのでしょうか"}},[t._v("#")]),t._v(" Keep Alive とは何ですか？また、キープアライブタイムアウトの値は何をするのでしょうか？")]),t._v(" "),a("p",[t._v("キープアライブとは、HTTP 1.1 で導入された HTTP の機能です。HTTPリクエストを送信するとき、クライアント(通常はウェブブラウザアプリケーション)は "),a("code",[t._v("Keep-Alive")]),t._v(" ヘッダを設定して、HTTPサーバ(Sanic)が応答を送信した後もTCP接続を閉じないように指示することができます。これにより、クライアントは後続のHTTPリクエストを送信するために既存のTCP接続を再利用することができ、クライアントとサーバーの両方にとってより効率的なネットワークトラフィックを確保することができます。")]),t._v(" "),a("p",[t._v("Sanicでは、"),a("code",[t._v("KEEP_ALIVE")]),t._v("設定変数がデフォルトで "),a("code",[t._v("True")]),t._v(" に設定されています。アプリケーションでこの機能を必要としない場合は、"),a("code",[t._v("False")]),t._v("に設定すると、リクエストの "),a("code",[t._v("Keep-Alive")]),t._v(" ヘッダに関係なく、レスポンスが送信された後にすべてのクライアント接続を直ちに終了するようになります。")]),t._v(" "),a("p",[t._v("サーバーが TCP 接続を開いたままにする時間は、サーバー自身が決定します。Sanic では、その値は "),a("code",[t._v("KEEP_ALIVE_TIMEOUT")]),t._v(" 値を使用して設定されます。デフォルトでは、5秒に設定されています。これは Apache HTTP サーバーと同じデフォルト設定で、クライアントが新しいリクエストを送信するのに十分な時間を与えることと、一度に多くのコネクションをオープンしないことのバランスが取れています。クライアントが、その時間だけ開いたままの TCP 接続をサポートするブラウザを使用していることが分かっている場合を除き、75 秒を超えないようにしてください。")]),t._v(" "),a("p",[t._v("参考までに")]),t._v(" "),a("ul",[a("li",[t._v("Apache httpd サーバーのデフォルトのキープアライブタイムアウト = 5 秒")]),t._v(" "),a("li",[t._v("Nginxサーバのデフォルトのキープアライブタイムアウトは75秒です。")]),t._v(" "),a("li",[t._v("Nginx パフォーマンスチューニングガイドラインでは、keepalive = 15 秒を使用しています。")]),t._v(" "),a("li",[t._v("IE（5-9）クライアントのハードキープアライブ制限 = 60秒")]),t._v(" "),a("li",[t._v("Firefoxクライアントハードキープアライブ制限=115秒")]),t._v(" "),a("li",[t._v("Opera 11クライアントハードキープアライブ制限 = 120秒")]),t._v(" "),a("li",[t._v("Chrome 13+のクライアントキープアライブ制限 > 300秒以上")])]),t._v(" "),a("h2",{attrs:{id:"プロキシ設定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#プロキシ設定"}},[t._v("#")]),t._v(" プロキシ設定")]),t._v(" "),a("p",[t._v("プロキシ設定の項](/guide/advanced/proxy-headers.md)を参照してください。")])])}),[],!1,null,null,null);a.default=n.exports}}]);