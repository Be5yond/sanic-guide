(window.webpackJsonp=window.webpackJsonp||[]).push([[265],{583:function(t,a,s){"use strict";s.r(a);var n=s(4),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"version-21-12"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#version-21-12"}},[t._v("#")]),t._v(" Version 21.12")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#介绍-introduction"}},[t._v("介绍(Introduction)")])]),a("li",[a("a",{attrs:{href:"#更新内容-what-to-know"}},[t._v("更新内容(What to know)")]),a("ul",[a("li",[a("a",{attrs:{href:"#更严格的应用程序和蓝图命名检查-strict-application-and-blueprint-names"}},[t._v("更严格的应用程序和蓝图命名检查(Strict application and blueprint names)")])]),a("li",[a("a",{attrs:{href:"#更严格的应用程序和蓝图属性检查-strict-application-and-blueprint-properties"}},[t._v("更严格的应用程序和蓝图属性检查(Strict application and blueprint properties)")])]),a("li",[a("a",{attrs:{href:"#功能迁移-removals"}},[t._v("功能迁移(Removals)")])]),a("li",[a("a",{attrs:{href:"#升级您的流式响应-如果您尚未准备好弃用"}},[t._v("升级您的流式响应 (如果您尚未准备好弃用)")])]),a("li",[a("a",{attrs:{href:"#cli-样式更新及每日消息-motd"}},[t._v("CLI 样式更新及每日消息(MOTD)")])]),a("li",[a("a",{attrs:{href:"#服务运行模式和-debug-的更改"}},[t._v("服务运行模式和 debug 的更改")])]),a("li",[a("a",{attrs:{href:"#最大线程数-max-allowed-workers"}},[t._v("最大线程数(Max allowed workers)")])]),a("li",[a("a",{attrs:{href:"#一流的-sanic-拓展支持-first-class-sanic-extensions-support"}},[t._v("一流的 Sanic 拓展支持(First-class Sanic Extensions support)")])]),a("li",[a("a",{attrs:{href:"#上下文异常-contextual-exceptions"}},[t._v("上下文异常(Contextual exceptions)")])]),a("li",[a("a",{attrs:{href:"#后台任务管理-background-task-management"}},[t._v("后台任务管理(Background task management)")])]),a("li",[a("a",{attrs:{href:"#定义路由中的上下文参数-route-context-kwargs-in-definitions"}},[t._v("定义路由中的上下文参数(Route context kwargs in definitions)")])]),a("li",[a("a",{attrs:{href:"#蓝图可以在任意时刻注册"}},[t._v("蓝图可以在任意时刻注册")])]),a("li",[a("a",{attrs:{href:"#通知异常-将所有的异常输出到日志中"}},[t._v("通知异常 (将所有的异常输出到日志中)")])]),a("li",[a("a",{attrs:{href:"#可枚举的信号事件"}},[t._v("可枚举的信号事件")])]),a("li",[a("a",{attrs:{href:"#自定义环境变量的类型转换"}},[t._v("自定义环境变量的类型转换")])]),a("li",[a("a",{attrs:{href:"#通过配置项禁用-uvloop"}},[t._v("通过配置项禁用 uvloop")])]),a("li",[a("a",{attrs:{href:"#使用多个-tls-证书运行-sanic-服务"}},[t._v("使用多个 TLS 证书运行 Sanic 服务")])])])]),a("li",[a("a",{attrs:{href:"#新闻-news"}},[t._v("新闻(News)")]),a("ul",[a("li",[a("a",{attrs:{href:"#即将发布-《sanic-web-开发》"}},[t._v("即将发布：《Sanic web 开发》")])]),a("li",[a("a",{attrs:{href:"#文档的深色模式-dark-mode-for-the-docs"}},[t._v("文档的深色模式(Dark mode for the docs)")])])])]),a("li",[a("a",{attrs:{href:"#鸣谢-thank-you"}},[t._v("鸣谢(Thank you)")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"介绍-introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍-introduction"}},[t._v("#")]),t._v(" 介绍(Introduction)")]),t._v(" "),a("p",[t._v("该版本为 21 版本 "),a("RouterLink",{attrs:{to:"/zh/org/policies.html#release-schedule"}},[t._v("发布周期")]),t._v(" 中的最后一个发行版本，目前 21 版本将进入长期维护状态，直至 2023 年 12 月。")],1),t._v(" "),a("h2",{attrs:{id:"更新内容-what-to-know"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新内容-what-to-know"}},[t._v("#")]),t._v(" 更新内容(What to know)")]),t._v(" "),a("p",[t._v("更多详情请见 "),a("a",{attrs:{href:"https://sanic.readthedocs.io/en/stable/sanic/changelog.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("更新记录"),a("OutboundLink")],1),t._v("。值得注意的新功能或突破性功能，以及要升级的内容...")]),t._v(" "),a("h3",{attrs:{id:"更严格的应用程序和蓝图命名检查-strict-application-and-blueprint-names"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更严格的应用程序和蓝图命名检查-strict-application-and-blueprint-names"}},[t._v("#")]),t._v(" 更严格的应用程序和蓝图命名检查(Strict application and blueprint names)")]),t._v(" "),a("p",[t._v("在 "),a("RouterLink",{attrs:{to:"/zh/guide/release-notes/v21.6.html#stricter-application-and-blueprint-names-and-deprecation"}},[t._v("v21.6")]),t._v(" 中，应用程序或蓝图的名称需要符合新的命名规范，现在该规范将在应用启动时进行强制检查。")],1),t._v(" "),a("p",[t._v("名称 "),a("strong",[t._v("必须")]),t._v(" 符合以下规则:")]),t._v(" "),a("ol",[a("li",[t._v("只允许使用字母和数字 ("),a("code",[t._v("a-zA-Z0-9")]),t._v(")")]),t._v(" "),a("li",[t._v("可以包含连接符 ("),a("code",[t._v("-")]),t._v(") 或下划线 ("),a("code",[t._v("_")]),t._v(")")]),t._v(" "),a("li",[t._v("必须以字母或者下划线开头 ("),a("code",[t._v("a-zA-Z_")]),t._v(")")])]),t._v(" "),a("h3",{attrs:{id:"更严格的应用程序和蓝图属性检查-strict-application-and-blueprint-properties"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更严格的应用程序和蓝图属性检查-strict-application-and-blueprint-properties"}},[t._v("#")]),t._v(" 更严格的应用程序和蓝图属性检查(Strict application and blueprint properties)")]),t._v(" "),a("p",[t._v("在以前的版本中，您可以直接将属性挂载到 "),a("code",[t._v("Sanic")]),t._v(" 或者 "),a("code",[t._v("Blueprint")]),t._v(" 上，现在您必须使用 "),a("code",[t._v("ctx")]),t._v(" 来进行属性设置。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyApp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Database"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"功能迁移-removals"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能迁移-removals"}},[t._v("#")]),t._v(" 功能迁移(Removals)")]),t._v(" "),a("p",[t._v("下面几种不推荐使用的方法已被移除:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("sanic.exceptions.abort")])]),t._v(" "),a("li",[a("code",[t._v("sanic.views.CompositionView")])]),t._v(" "),a("li",[a("code",[t._v("sanic.response.StreamingHTTPResponse")])])]),t._v(" "),a("h3",{attrs:{id:"升级您的流式响应-如果您尚未准备好弃用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#升级您的流式响应-如果您尚未准备好弃用"}},[t._v("#")]),t._v(" 升级您的流式响应 (如果您尚未准备好弃用)")]),t._v(" "),a("p",[a("code",[t._v("sanic.response.stream")]),t._v(" 响应方法已被 "),a("strong",[t._v("弃用")]),t._v(" 并将在 v22.6 版本中删除。如果您仍在使用旧的流式响应，请将其升级。")]),t._v(" "),a("p",[a("strong",[t._v("旧用法 - 已弃用")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sample_streaming_fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo,"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" stream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sample_streaming_fn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" content_type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("strong",[t._v("临时替代方案")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sample_streaming_fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo,"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("respond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("content_type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo,"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"cli-样式更新及每日消息-motd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cli-样式更新及每日消息-motd"}},[t._v("#")]),t._v(" CLI 样式更新及每日消息(MOTD)")]),t._v(" "),a("p",[t._v("Sanic CLI 获得了升级，它增加了非常多的新功能，使其能够与 "),a("code",[t._v("app.run")]),t._v(" 一较高下。它还包含了一个全新的 MOTD 显示功能。让您快速的对当前环境配置有一个了解。MOTD 和 TTY 是互相感知的，因此它在您的日志中并不会有更详细的记录，主要目的是为了方便应用程序的开发。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ sanic --help\nusage: sanic [-h] [--version] [--factory] [-s] [-H HOST] [-p PORT] [-u UNIX] [--cert CERT] [--key KEY] [--tls DIR] [--tls-strict-host]\n             [-w WORKERS | --fast] [--access-logs | --no-access-logs] [--debug] [-d] [-r] [-R PATH] [--motd | --no-motd] [-v]\n             [--noisy-exceptions | --no-noisy-exceptions]\n             module\n\n   ▄███ █████ ██      ▄█▄      ██       █   █   ▄██████████\n  ██                 █   █     █ ██     █   █  ██\n   ▀███████ ███▄    ▀     █    █   ██   ▄   █  ██\n               ██  █████████   █     ██ █   █  ▄▄\n  ████ ████████▀  █         █  █       ██   █   ▀██ ███████\n\n To start running a Sanic application, provide a path to the module, where\n app is a Sanic() instance:\n\n     $ sanic path.to.server:app\n\n Or, a path to a callable that returns a Sanic() instance:\n\n     $ sanic path.to.factory:create_app --factory\n\n Or, a path to a directory to run as a simple HTTP server:\n\n     $ sanic ./path/to/static --simple\n\nRequired\n========\n  Positional:\n    module                         Path to your Sanic app. Example: path.to.server:app\n                                   If running a Simple Server, path to directory to serve. Example: ./\n\nOptional\n========\n  General:\n    -h, --help                     show this help message and exit\n    --version                      show program's version number and exit\n\n  Application:\n    --factory                      Treat app as an application factory, i.e. a () -> <Sanic app> callable\n    -s, --simple                   Run Sanic as a Simple Server, and serve the contents of a directory\n                                   (module arg should be a path)\n\n  Socket binding:\n    -H HOST, --host HOST           Host address [default 127.0.0.1]\n    -p PORT, --port PORT           Port to serve on [default 8000]\n    -u UNIX, --unix UNIX           location of unix socket\n\n  TLS certificate:\n    --cert CERT                    Location of fullchain.pem, bundle.crt or equivalent\n    --key KEY                      Location of privkey.pem or equivalent .key file\n    --tls DIR                      TLS certificate folder with fullchain.pem and privkey.pem\n                                   May be specified multiple times to choose multiple certificates\n    --tls-strict-host              Only allow clients that send an SNI matching server certs\n\n  Worker:\n    -w WORKERS, --workers WORKERS  Number of worker processes [default 1]\n    --fast                         Set the number of workers to max allowed\n    --access-logs                  Display access logs\n    --no-access-logs               No display access logs\n\n  Development:\n    --debug                        Run the server in debug mode\n    -d, --dev                      Currently is an alias for --debug. But starting in v22.3,\n                                   --debug will no longer automatically trigger auto_restart.\n                                   However, --dev will continue, effectively making it the\n                                   same as debug + auto_reload.\n    -r, --reload, --auto-reload    Watch source directory for file changes and reload on changes\n    -R PATH, --reload-dir PATH     Extra directories to watch and reload on changes\n\n  Output:\n    --motd                         Show the startup display\n    --no-motd                      No show the startup display\n    -v, --verbosity                Control logging noise, eg. -vv or --verbosity=2 [default 0]\n    --noisy-exceptions             Output stack traces for all exceptions\n    --no-noisy-exceptions          No output stack traces for all exceptions\n")])])]),a("h3",{attrs:{id:"服务运行模式和-debug-的更改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务运行模式和-debug-的更改"}},[t._v("#")]),t._v(" 服务运行模式和 "),a("code",[t._v("debug")]),t._v(" 的更改")]),t._v(" "),a("p",[t._v("目前拥有的两个运行模式是：开发("),a("code",[t._v("DEV")]),t._v(") 和 生产("),a("code",[t._v("PRODUCTION")]),t._v(") Sanic 服务在生产模式下运行，这是为部署而设计的。")]),t._v(" "),a("p",[t._v("目前，"),a("code",[t._v("DEV")]),t._v(" 模式的运行方式与旧版本 Sanic 中的 "),a("code",[t._v("debug=True")]),t._v(" 非常相似。但是，在 v22.3 中，"),a("code",[t._v("debug=True")]),t._v(" 将 "),a("strong",[t._v("不再")]),t._v(" 启用自动重载功能。如果您想要调试和自动重载，您应该启用 开发("),a("code",[t._v("dev")]),t._v(") 模式。")]),t._v(" "),a("p",[a("strong",[t._v("开发模式")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ sanic server:app --dev\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("debug"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" auto_reload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("strong",[t._v("生产模式")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ sanic server:app\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("从 v22.3 版本开始，生产模式下将不再默认启用访问日志。")]),t._v(" "),a("p",[t._v("变化摘要如下:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("标志")]),t._v(" "),a("th",[t._v("模式")]),t._v(" "),a("th",[t._v("错误追溯")]),t._v(" "),a("th",[t._v("日志")]),t._v(" "),a("th",[t._v("访问日志")]),t._v(" "),a("th",[t._v("自动重载")]),t._v(" "),a("th",[t._v("最大 works")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("--debug")]),t._v(" "),a("td",[t._v("DEBUG")]),t._v(" "),a("td",[t._v("yes")]),t._v(" "),a("td",[t._v("DEBUG")]),t._v(" "),a("td",[t._v("yes")]),t._v(" "),a("td",[t._v("^1")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td",[t._v("PROD")]),t._v(" "),a("td",[t._v("no")]),t._v(" "),a("td",[t._v("INFO ^2")]),t._v(" "),a("td",[t._v("^3")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("--dev")]),t._v(" "),a("td",[t._v("DEBUG")]),t._v(" "),a("td",[t._v("yes")]),t._v(" "),a("td",[t._v("DEBUG")]),t._v(" "),a("td",[t._v("yes")]),t._v(" "),a("td",[t._v("yes")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("--fast")]),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td",[t._v("yes")])])])]),t._v(" "),a("ul",[a("li",[t._v("^1 "),a("code",[t._v("--debug")]),t._v(" 参数将在 v22.3 版本中移除自动重载功能")]),t._v(" "),a("li",[t._v("^2 在 v22.3 版本后将日志级别变更为 WARNING")]),t._v(" "),a("li",[t._v("^3 在 v22.3 版本后将被关闭")])]),t._v(" "),a("h3",{attrs:{id:"最大线程数-max-allowed-workers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最大线程数-max-allowed-workers"}},[t._v("#")]),t._v(" 最大线程数(Max allowed workers)")]),t._v(" "),a("p",[t._v("现在您可以通过 "),a("code",[t._v("--fast")]),t._v(" 参数来轻松以最大线程数运行您的应用程序了。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ sanic server:app --fast\n")])])]),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fast"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"一流的-sanic-拓展支持-first-class-sanic-extensions-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一流的-sanic-拓展支持-first-class-sanic-extensions-support"}},[t._v("#")]),t._v(" 一流的 Sanic 拓展支持(First-class Sanic Extensions support)")]),t._v(" "),a("p",[a("RouterLink",{attrs:{to:"/zh/plugins/sanic-ext/getting-started.html"}},[t._v("Sanic 拓展")]),t._v(" 提供了许多专门针对 API 开发者的拓展功能，现在只要您在 python 环境中安装了 Sanic 拓展 就能够轻松地使用其所有功能，无需进行额外的设置，这些功能包括：")],1),t._v(" "),a("ul",[a("li",[t._v("能够自动创建 "),a("code",[t._v("HEAD")]),t._v("， "),a("code",[t._v("OPTIONS")]),t._v("，和 "),a("code",[t._v("TRACE")]),t._v(" 响应程序")]),t._v(" "),a("li",[t._v("具有跨域保护")]),t._v(" "),a("li",[t._v("具有内置于指定响应程序的响应序列化器")]),t._v(" "),a("li",[t._v("允许进行路由参数的注入")]),t._v(" "),a("li",[t._v("完美适配 Redoc 和 Swagger")]),t._v(" "),a("li",[t._v("能够对请求参数和请求体进行验证")])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ pip install sanic[ext]\n")])])])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ pip install sanic sanic-ext\n")])])])])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ pip install sanic[ext]\n")])])])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ pip install sanic sanic-ext\n")])])])])]),t._v(" "),a("p",[t._v("最好的安装方式就是在安装 Sanic 的同时一并安装 Sanic 拓展，当然，您也可以独立安装：")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ pip install sanic[ext]\n")])])])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ pip install sanic sanic-ext\n")])])])])]),t._v(" "),a("p",[t._v("之后，"),a("strong",[t._v("不需要额外的配置")]),t._v("。Sanic 拓展将自动附加到您的应用程序，并提供所有拓展功能。")]),t._v(" "),a("p",[t._v("如果你想改变其工作方式，或者提供额外的配置，你可以使用 "),a("code",[t._v("app.extend")]),t._v(" 来改变 Sanic 拓展。"),a("code",[t._v("Config")]),t._v(" 对象是为 ide 开发提供有用的类型注释。")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This is optional, not required")]),t._v("\napp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyApp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oas_url_prefix"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/apidocs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This is optional, not required")]),t._v("\napp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyApp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OAS_URL_PREFIX "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/apidocs"')]),t._v("\n")])])])])]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This is optional, not required")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic_ext "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Config\n\napp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MyApp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oas_url_prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/apidocs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}})]),t._v(" "),a("h3",{attrs:{id:"上下文异常-contextual-exceptions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#上下文异常-contextual-exceptions"}},[t._v("#")]),t._v(" 上下文异常(Contextual exceptions)")]),t._v(" "),a("p",[t._v("在"),a("RouterLink",{attrs:{to:"/zh/guide/release-notes/v21.9.html#default-exception-messages"}},[t._v("v21.9")]),t._v(" 版本中，我们向异常添加了默认消息，简化了在整个应用程序中一致引发异常的能力。")],1),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TeapotError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SanicException"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    status_code "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("418")]),t._v("\n    message "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sorry, I cannot brew coffee"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" TeapotError\n")])])]),a("p",[t._v("但这样会忽视两个非常重要的问题：")]),t._v(" "),a("ol",[a("li",[t._v("如何设置动态且可预测的消息格式")]),t._v(" "),a("li",[t._v("如何向错误消息中添加额外上下文内容")])]),t._v(" "),a("p",[t._v("当前版本允许任何 Sanic 异常在引发时具有附加信息，以便在编写错误消息时提供上下文:")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TeapotError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SanicException"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    status_code "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("418")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@property")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string-interpolation"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"Sorry ')]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extra"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(', I cannot make you coffee"')])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" TeapotError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("extra"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adam"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("新特性允许您向异常传递额外的信息，在生产模式下，该信息将不会被输出，但是在开发模式下它将进行显示。")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[a("strong",[t._v("生产模式")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-images.githubusercontent.com/166269/139014161-cda67cd1-843f-4ad2-9fa1-acb94a59fc4d.png",alt:"image"}})])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[a("strong",[t._v("开发模式")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-images.githubusercontent.com/166269/139014121-0596b084-b3c5-4adb-994e-31ba6eba6dad.png",alt:"image"}})])])]),t._v(" "),a("p",[t._v("回到我们刚才提到的第二个问题：如何向错误消息中添加额外上下文内容")]),t._v(" "),a("p",[t._v("这在创建微服务或 API 时特别有用，因为您希望以 JSON 格式传回错误消息。在这个用例中，我们希望有一些关于异常的上下文，而不仅仅是一个可解析的错误消息，以便向客户端返回详细信息。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" TeapotError"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("这是我们希望 "),a("strong",[t._v("始终在错误中传递的信息")]),t._v("(如果可用)。它应该是这样的:")]),t._v(" "),a("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[a("strong",[t._v("生产模式")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I\'m a teapot"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("418")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"message"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sorry Adam, I cannot make you coffee"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"context"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"foo"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[a("p",[a("strong",[t._v("开发模式")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I\'m a teapot"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("418")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"message"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sorry Adam, I cannot make you coffee"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"context"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"foo"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extra"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Adam"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"more"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lines"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"complex"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"one"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"two"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"args"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"exceptions"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TeapotError"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"exception"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sorry Adam, I cannot make you coffee"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"frames"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"file"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"handle_request"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"line"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("83")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"handle_request"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"src"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"file"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tmp/p.py"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"line"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"handler"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"src"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"raise TeapotError("')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"后台任务管理-background-task-management"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后台任务管理-background-task-management"}},[t._v("#")]),t._v(" 后台任务管理(Background task management)")]),t._v(" "),a("p",[t._v("当使用 "),a("code",[t._v("app.add_task")]),t._v(" 方法创建后台任务时，可以额外的设置一个 "),a("code",[t._v("name")]),t._v(" 参数，方便后续获取或取消任务。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_task"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dummy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dummy_task"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_task"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dummy_task"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cancel_task"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dummy_task"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"定义路由中的上下文参数-route-context-kwargs-in-definitions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定义路由中的上下文参数-route-context-kwargs-in-definitions"}},[t._v("#")]),t._v(" 定义路由中的上下文参数(Route context kwargs in definitions)")]),t._v(" "),a("p",[t._v("定义路由时，您可以添加任意数量的带有' ctx_ '前缀的关键字参数。这些值将被注入到路由“ctx”对象中。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx_label"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"something"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx_label"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"something"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/99"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler99")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on_request")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("do_something")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("label "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"something"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("h3",{attrs:{id:"蓝图可以在任意时刻注册"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#蓝图可以在任意时刻注册"}},[t._v("#")]),t._v(" 蓝图可以在任意时刻注册")]),t._v(" "),a("p",[t._v("在以前的 Sanic 版本中，蓝图的注册顺序有着严格的限制，如果您在响应函数注册到蓝图之前将蓝图注册到应用程序中，这些对象将会丢失。")]),t._v(" "),a("p",[t._v("现在，您可以随时注册一个蓝图，所有被注册到蓝图上的响应函数都将在启动时被包含。")]),t._v(" "),a("h3",{attrs:{id:"通知异常-将所有的异常输出到日志中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通知异常-将所有的异常输出到日志中"}},[t._v("#")]),t._v(" 通知异常 (将所有的异常输出到日志中)")]),t._v(" "),a("p",[t._v("新增了一个 "),a("code",[t._v("NOISY_EXCEPTIONS")]),t._v(" 配置项，该配置项默认为 False。 Sanic 支持任何静默异常，这意味着如果您在捕获异常后设置了 "),a("code",[t._v("quiet=False")]),t._v(" 参数，该异常将不会在日志中输出。")]),t._v(" "),a("p",[t._v("但是当您设置了 "),a("code",[t._v("NOISY_EXCEPTIONS")]),t._v(" 为 True 时，无论 "),a("code",[t._v("quiet")]),t._v(" 如何进行设置，都将被记录。")]),t._v(" "),a("p",[t._v("这在调试时极为有用。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NOISY_EXCEPTIONS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n")])])]),a("h3",{attrs:{id:"可枚举的信号事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可枚举的信号事件"}},[t._v("#")]),t._v(" 可枚举的信号事件")]),t._v(" "),a("p",[t._v("为了方便，我们内置了一个能够枚举所有信号的事件")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("signals "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Event\n\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("signal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HTTP_LIFECYCLE_BEGIN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("connection_opened")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("conn_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("h3",{attrs:{id:"自定义环境变量的类型转换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义环境变量的类型转换"}},[t._v("#")]),t._v(" 自定义环境变量的类型转换")]),t._v(" "),a("p",[t._v("默认情况下，在环境变量中加载 config 配置的时候，Sanic 将主动转换配置为可能的类型，您可以通过配置转换器来进行控制：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("converters"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("UUID"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"通过配置项禁用-uvloop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过配置项禁用-uvloop"}},[t._v("#")]),t._v(" 通过配置项禁用 "),a("code",[t._v("uvloop")])]),t._v(" "),a("p",[t._v("现在 "),a("code",[t._v("uvloop")]),t._v(" 的使用可由配置值进行控制:")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("USE_UVLOOP "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n")])])]),a("h3",{attrs:{id:"使用多个-tls-证书运行-sanic-服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用多个-tls-证书运行-sanic-服务"}},[t._v("#")]),t._v(" 使用多个 TLS 证书运行 Sanic 服务")]),t._v(" "),a("p",[t._v("现在 Sanic 支持使用多个不同的 TLS 证书运行：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    ssl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/letsencrypt/live/example.com/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/etc/letsencrypt/live/mysite.example/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"新闻-news"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新闻-news"}},[t._v("#")]),t._v(" 新闻(News)")]),t._v(" "),a("h3",{attrs:{id:"即将发布-《sanic-web-开发》"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#即将发布-《sanic-web-开发》"}},[t._v("#")]),t._v(" 即将发布：《Sanic web 开发》")]),t._v(" "),a("p",[t._v("由 Sanic 核心开发人员 "),a("a",{attrs:{href:"https://github.com/ahopkins",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ahopkins"),a("OutboundLink")],1),t._v(" 主笔的新书即将发布，访问 "),a("a",{attrs:{href:"https://sanicbook.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("sanicbook.com"),a("OutboundLink")],1),t._v(" 了解更多信息。")]),t._v(" "),a("blockquote",[a("p",[t._v("掌握使用 Sanic 的实用知识，以提高 web 应用程序的性能和可伸缩性。除此之外，我们将提高您的开发技能，让您学会定制您的应用程序，以满足不断变化的业务需求，而不必对应用程序进行重大的过度设计。")])]),t._v(" "),a("p",[t._v("该书的收入将按照一定的比例捐赠给 SCO ，用于 Sanic 的进一步发展。因此购买此书是你支持 Sanic 发展的另一种方式。")]),t._v(" "),a("h3",{attrs:{id:"文档的深色模式-dark-mode-for-the-docs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文档的深色模式-dark-mode-for-the-docs"}},[t._v("#")]),t._v(" 文档的深色模式(Dark mode for the docs)")]),t._v(" "),a("p",[t._v("如果您还没有注意到，该网站现在支持原生在深色模式和浅色模式之间进行切换，您可以通过页面的右上角来进行手动切换。")]),t._v(" "),a("h2",{attrs:{id:"鸣谢-thank-you"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#鸣谢-thank-you"}},[t._v("#")]),t._v(" 鸣谢(Thank you)")]),t._v(" "),a("p",[t._v("感谢每一位参与本次发布的人：👏")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/adarsharegmi",target:"_blank",rel:"noopener noreferrer"}},[t._v("@adarsharegmi"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/ahopkins",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ahopkins"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/ashleysommer",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ashleysommer"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/ChihweiLHBird",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ChihweiLHBird"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/cnicodeme",target:"_blank",rel:"noopener noreferrer"}},[t._v("@cnicodeme"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/kianmeng",target:"_blank",rel:"noopener noreferrer"}},[t._v("@kianmeng"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/meysam81",target:"_blank",rel:"noopener noreferrer"}},[t._v("@meysam81"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/nuxion",target:"_blank",rel:"noopener noreferrer"}},[t._v("@nuxion"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/prryplatypus",target:"_blank",rel:"noopener noreferrer"}},[t._v("@prryplatypus"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/realDragonium",target:"_blank",rel:"noopener noreferrer"}},[t._v("@realDragonium"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/SaidBySolo",target:"_blank",rel:"noopener noreferrer"}},[t._v("@SaidBySolo"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/sjsadowski",target:"_blank",rel:"noopener noreferrer"}},[t._v("@sjsadowski"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/tronic",target:"_blank",rel:"noopener noreferrer"}},[t._v("@Tronic"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/Varriount",target:"_blank",rel:"noopener noreferrer"}},[t._v("@Varriount"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/vltr",target:"_blank",rel:"noopener noreferrer"}},[t._v("@vltr"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://github.com/whos4n3",target:"_blank",rel:"noopener noreferrer"}},[t._v("@whos4n3"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("并且，特别感谢 "),a("a",{attrs:{href:"https://github.com/miss85246",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ConnorZhang"),a("OutboundLink")],1),t._v(" 和 "),a("a",{attrs:{href:"https://github.com/ZinkLu",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ZinkLu"),a("OutboundLink")],1),t._v("，他们在同步翻译最新中文文档上付出了巨大精力。")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("如果您喜欢本项目，请考虑参与建设本项目。我们欢迎您提交代码，也欢迎您以任何其他方式来参与本项目的建设。比如撰写文档，分享使用心得，参与社区讨论，当然，如果经济允许，您也可以考虑"),a("a",{attrs:{href:"https://opencollective.com/sanic-org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("经济资助"),a("OutboundLink")],1),t._v("。")])])}),[],!1,null,null,null);a.default=e.exports}}]);