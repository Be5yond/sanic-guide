(window.webpackJsonp=window.webpackJsonp||[]).push([[279],{597:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"http-方法-http-methods"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-方法-http-methods"}},[t._v("#")]),t._v(" HTTP 方法（HTTP Methods）")]),t._v(" "),s("h2",{attrs:{id:"自动生成响应程序-auto-endpoints"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动生成响应程序-auto-endpoints"}},[t._v("#")]),t._v(" 自动生成响应程序（Auto-endpoints）")]),t._v(" "),s("p",[t._v("其默认行为是为所有的 "),s("code",[t._v("GET")]),t._v(" 路由自动生成 "),s("code",[t._v("HEAD")]),t._v(" 响应程序，为所有路由自动生成 "),s("code",[t._v("OPTIONS")]),t._v(" 响应程序。 此外，还有自动生成 "),s("code",[t._v("TRACE")]),t._v(" 响应程序的选项。 但是该功能在默认设置下并不会启用。")]),t._v(" "),s("tabs",[s("tab",{attrs:{name:"HEAD"}},[s("ul",[s("li",[s("strong",[t._v("配置参数")]),t._v("："),s("code",[t._v("AUTO_HEAD")]),t._v(" (默认值 "),s("code",[t._v("True")]),t._v(")")]),t._v(" "),s("li",[s("strong",[t._v("MDN")]),t._v("："),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/HEAD",target:"_blank",rel:"noopener noreferrer"}},[t._v("了解更多"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("code",[t._v("HEAD")]),t._v(" 请求提供请求头以及与 "),s("code",[t._v("GET")]),t._v(" 请求将提供的相同地响应。 但是，它实际上并没有返回主体。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hello_world")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello, world."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("给定上述路由定义，Sanic 拓展将启用 "),s("code",[t._v("HEAD")]),t._v(" 响应，如下所示。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ curl localhost:8000 --head\nHTTP/1.1 200 OK\naccess-control-allow-origin: *\ncontent-length: 13\nconnection: keep-alive\ncontent-type: text/plain; charset=utf-8\n")])])])]),t._v(" "),s("tab",{attrs:{name:"OPTIONS"}},[s("ul",[s("li",[s("strong",[t._v("配置参数")]),t._v("： "),s("code",[t._v("AUTO_OPTIONS")]),t._v(" (默认值 "),s("code",[t._v("True")]),t._v(")")]),t._v(" "),s("li",[s("strong",[t._v("MDN")]),t._v("： "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/OPTIONS",target:"_blank",rel:"noopener noreferrer"}},[t._v("Read more"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("code",[t._v("OPTIONS")]),t._v(" 请求将会向请求者返回关如何允许客户端与对应响应函数进行通信的详细信息。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hello_world")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello, world."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("给定上述路由定义，Sanic 拓展将启用 "),s("code",[t._v("OPTIONS")]),t._v(" 响应，如下所示。")]),t._v(" "),s("p",[t._v("另外，值得注意的是，在这个例子中，我们还看到了 "),s("code",[t._v("access-control-allow-origins")]),t._v(" 请求头。这是因为默认情况下，"),s("RouterLink",{attrs:{to:"/zh/plugins/sanic-ext/http/cors.html"}},[t._v("CORS保护")]),t._v(" 是启用状态的。")],1),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ curl localhost:8000 -X OPTIONS -i\nHTTP/1.1 204 No Content\nallow: GET,HEAD,OPTIONS\naccess-control-allow-origin: *\nconnection: keep-alive\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("小提示")]),t._v(" "),s("p",[t._v("Sanic 拓展将会自动为您创建 "),s("code",[t._v("OPTIONS")]),t._v(" 路由， 即便您选择手动创建一个 "),s("code",[t._v("@app.options")]),t._v(" 的路由，它也不会被覆盖掉。")])])]),t._v(" "),s("tab",{attrs:{name:"TRACE"}},[s("ul",[s("li",[s("strong",[t._v("配置参数")]),t._v("： "),s("code",[t._v("AUTO_TRACE")]),t._v(" (默认值 "),s("code",[t._v("False")]),t._v(")")]),t._v(" "),s("li",[s("strong",[t._v("MDN")]),t._v("： "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/TRACE",target:"_blank",rel:"noopener noreferrer"}},[t._v("Read more"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("默认情况下，"),s("code",[t._v("TRACE")]),t._v(" 响应函数是 "),s("strong",[t._v("不会")]),t._v(" 被自动创建的，当然，如果您需要，Sanic 拓展允许为您自动创建，这在普通的 Sanic 应用程序中是禁止的。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"trace"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("想要允许 Sanic 拓展为您自动创建 TRACE 响应函数，您必须在拓展 Sanic 的时候启用它们：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic_ext "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Extend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Config\n\nExtend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("auto_trace"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("现在，假设您有一些响应函数设置，您可以跟踪它们，如下所示:")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ curl localhost:8000 -X TRACE\nTRACE / HTTP/1.1\nHost: localhost:9999\nUser-Agent: curl/7.76.1\nAccept: */*\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("小提示")]),t._v(" "),s("p",[t._v("设置 "),s("code",[t._v("AUTO_TRACE")]),t._v(" 是非常有帮助的，尤其是当您的应用程序部署在代理后面时，因为它会帮助您确定代理的行为。")])])])],1),t._v(" "),s("h2",{attrs:{id:"额外方法的支持-additional-method-support"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#额外方法的支持-additional-method-support"}},[t._v("#")]),t._v(" 额外方法的支持（Additional method support）")]),t._v(" "),s("p",[t._v("普通的 Sanic 应用程序允许您使用以下 HTTP 方法构建响应程序：")]),t._v(" "),s("ul",[s("li",[s("RouterLink",{attrs:{to:"/zh/guide/basics/routing.html#get"}},[t._v("GET")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/zh/guide/basics/routing.html#post"}},[t._v("POST")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/zh/guide/basics/routing.html#put"}},[t._v("PUT")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/zh/guide/basics/routing.html#head"}},[t._v("HEAD")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/zh/guide/basics/routing.html#options"}},[t._v("OPTIONS")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/zh/guide/basics/routing.html#patch"}},[t._v("PATCH")])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/zh/guide/basics/routing.html#delete"}},[t._v("DELETE")])],1)]),t._v(" "),s("p",[t._v("查看 "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN Web Docs"),s("OutboundLink")],1),t._v(" 以了解更多。")]),t._v(" "),s("div",{staticClass:"multicolumn",staticStyle:{display:"flex","flex-direction":"row","align-items":"flex-start"}},[s("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[s("p",[t._v("然而，还有两种 “标准” HTTP方法："),s("code",[t._v("TRACE")]),t._v(" 和 "),s("code",[t._v("CONNECT")]),t._v("。Sanic 扩展将允许您构建使用这些方法的响应函数，这在普通的 Sanic 应用程序上是禁止的。")]),t._v(" "),s("p",[t._v("需要指出的是，Sanic 拓展并 "),s("strong",[t._v("不能")]),t._v(" 允许您直接使用 "),s("code",[t._v("@app.trace")]),t._v(" 或 "),s("code",[t._v("@app.connect")]),t._v(" 来创建使用对应 HTTP 方法的响应程序，您需要使用 "),s("code",[t._v("@app.route")]),t._v(" 来进行创建，如 👉 所示：")])]),t._v(" "),s("div",{staticClass:"multicolumn-column",staticStyle:{"flex-grow":"1","flex-basis":"0"}},[s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"trace"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"connect"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" empty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])])],1)}),[],!1,null,null,null);s.default=e.exports}}]);