(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{636:function(t,a,s){"use strict";s.r(a);var e=s(20),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"バージョン21-9"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#バージョン21-9"}},[t._v("#")]),t._v(" バージョン21.9")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#概要"}},[t._v("概要")])]),s("li",[s("a",{attrs:{href:"#知っておきたい"}},[t._v("知っておきたい")]),s("ul",[s("li",[s("a",{attrs:{href:"#設定値の削除-websocket-read-limit-、-websocket-write-limit-、-websocket-max-queue"}},[t._v("設定値の削除: WEBSOCKET_READ_LIMIT、WEBSOCKET_WRITE_LIMIT、WEBSOCKET_MAX_QUEUE")])]),s("li",[s("a",{attrs:{href:"#fallback-error-format-のデフォルト値の非推奨"}},[t._v("FALLBACK_ERROR_FORMATのデフォルト値の非推奨")])]),s("li",[s("a",{attrs:{href:"#errorhandler-lookup-署名の非推奨"}},[t._v("ErrorHandler.lookup署名の非推奨")])]),s("li",[s("a",{attrs:{href:"#今後の機能削除のお知らせ"}},[t._v("今後の機能削除のお知らせ")])]),s("li",[s("a",{attrs:{href:"#ウェブソケットの全面見直し"}},[t._v("ウェブソケットの全面見直し")])]),s("li",[s("a",{attrs:{href:"#ビルトイン信号"}},[t._v("ビルトイン信号")])]),s("li",[s("a",{attrs:{href:"#より賢い-自動-例外フォーマット"}},[t._v("より賢い自動例外フォーマット")])]),s("li",[s("a",{attrs:{href:"#ブループリントのコピー"}},[t._v("ブループリントのコピー")])]),s("li",[s("a",{attrs:{href:"#ブループリントグループの便利なメソッド"}},[t._v("ブループリントグループの便利なメソッド")])]),s("li",[s("a",{attrs:{href:"#acceptヘッダーの解析"}},[t._v("Acceptヘッダーの解析")])]),s("li",[s("a",{attrs:{href:"#デフォルトの例外メッセージ"}},[t._v("デフォルトの例外メッセージ")])]),s("li",[s("a",{attrs:{href:"#型アノテーションの利便機能"}},[t._v("型アノテーションの利便機能")])]),s("li",[s("a",{attrs:{href:"#明示的な静的リソース型"}},[t._v("明示的な静的リソース型")])])])]),s("li",[s("a",{attrs:{href:"#ニュース"}},[t._v("ニュース")]),s("ul",[s("li",[s("a",{attrs:{href:"#sanic-ext-のリリースと-sanic-openapi-の非推奨化"}},[t._v("sanic-ext のリリースと sanic-openapi の非推奨化")])])])]),s("li",[s("a",{attrs:{href:"#感謝"}},[t._v("感謝")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"概要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概要"}},[t._v("#")]),t._v(" 概要")]),t._v(" "),s("p",[t._v("これはバージョン21の3つ目の"),s("RouterLink",{attrs:{to:"/ja/org/policies.html#release-schedule"}},[t._v("リリースサイクル")]),t._v("です。 バージョン21は、12月の長期サポート版リリースで「確定」する予定です。")],1),t._v(" "),s("h2",{attrs:{id:"知っておきたい"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#知っておきたい"}},[t._v("#")]),t._v(" 知っておきたい")]),t._v(" "),s("p",[t._v("詳しくは"),s("a",{attrs:{href:"https://sanic.readthedocs.io/en/stable/sanic/changelog.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Changelog"),s("OutboundLink")],1),t._v("をご覧ください。注目すべき新機能・不具合、アップグレード対象など...")]),t._v(" "),s("h3",{attrs:{id:"設定値の削除-websocket-read-limit、websocket-write-limit、websocket-max-queue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#設定値の削除-websocket-read-limit、websocket-write-limit、websocket-max-queue"}},[t._v("#")]),t._v(" 設定値の削除: "),s("code",[t._v("WEBSOCKET_READ_LIMIT")]),t._v("、"),s("code",[t._v("WEBSOCKET_WRITE_LIMIT")]),t._v("、"),s("code",[t._v("WEBSOCKET_MAX_QUEUE")])]),t._v(" "),s("p",[t._v("ウェブソケット実装の全面的な見直しに伴い、これらの設定値は削除されました。現在、これらを置き換える予定はありません。")]),t._v(" "),s("h3",{attrs:{id:"fallback-error-formatのデフォルト値の非推奨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fallback-error-formatのデフォルト値の非推奨"}},[t._v("#")]),t._v(" "),s("code",[t._v("FALLBACK_ERROR_FORMAT")]),t._v("のデフォルト値の非推奨")]),t._v(" "),s("p",[t._v("エラーハンドラが添付されていない場合、Sanicはフォールバックのフォーマットタイプとして"),s("code",[t._v("html")]),t._v("を使用してきました。これは非推奨となり、v22.3から"),s("code",[t._v("text")]),t._v("に変更される予定です。この値は "),s("code",[t._v("auto")]),t._v(" に変更されましたが、変更前の v21.12LTS までは、最後の手段として HTML を使用し続けるでしょう。")]),t._v(" "),s("h3",{attrs:{id:"errorhandler-lookup署名の非推奨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#errorhandler-lookup署名の非推奨"}},[t._v("#")]),t._v(" "),s("code",[t._v("ErrorHandler.lookup")]),t._v("署名の非推奨")]),t._v(" "),s("p",[s("code",[t._v("ErrorHandler.lookup")]),t._v("は今、2つの位置専用引数を"),s("strong",[t._v("必須")]),t._v("にしています:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lookup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exception"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" route_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Optional"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),s("p",[t._v("不適合なメソッドを使用すると、Blueprint 固有の例外ハンドラが適切にアタッチされない原因となります。")]),t._v(" "),s("h3",{attrs:{id:"今後の機能削除のお知らせ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#今後の機能削除のお知らせ"}},[t._v("#")]),t._v(" 今後の機能削除のお知らせ")]),t._v(" "),s("p",[t._v("注意点として、以下の項目はすでに非推奨となっており、バージョン21.12LTSで削除される予定です。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("CompositionView")])]),t._v(" "),s("li",[s("code",[t._v("load_env")]),t._v(" (代わりに "),s("code",[t._v("env_prefix")]),t._v(" を使用)")]),t._v(" "),s("li",[t._v("サニックオブジェクト（アプリケーションインスタンス、ブループリント、ルート）は、以下に準拠した英数字を使用する必要があります。"),s("code",[t._v("^[a-zA-Z][a-zA-Z0-9_\\-]*$")])]),t._v(" "),s("li",[t._v("アプリケーションとブループリントのインスタンスへのオブジェクトの任意の割り当て (代わりに "),s("code",[t._v("ctx")]),t._v(" を使用します。この削除は 21.9 から 21.12 にバンプされました)")])]),t._v(" "),s("h3",{attrs:{id:"ウェブソケットの全面見直し"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ウェブソケットの全面見直し"}},[t._v("#")]),t._v(" ウェブソケットの全面見直し")]),t._v(" "),s("p",[t._v("ウェブソケット接続の取り扱いについて、大きな見直しが行われました。"),s("a",{attrs:{href:"https://github.com/aaugustin",target:"_blank",rel:"noopener noreferrer"}},[t._v("@augustin"),s("OutboundLink")],1),t._v(" のおかげで、"),s("a",{attrs:{href:"https://websockets.readthedocs.io/en/stable/index.html",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("websockets")]),s("OutboundLink")],1),t._v(" に新しい実装が追加され、Sanic が自分自身でウェブソケット接続の I/O を処理することができるようになりました。そのため、Sanicは最小バージョンを "),s("code",[t._v("websockets>=10.0")]),t._v(" に引き上げました。")]),t._v(" "),s("p",[t._v("この変更は、Sanicのウェブソケットハンドラに関するいくつかの奇妙な点が修正されたことを除けば、開発者にはほとんど気づかれないはずです。例えば、誰かが切断したときに "),s("code",[t._v("CancellError")]),t._v(" を自分で捕らえることができるようになったはずです。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("websocket")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ws"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" asyncio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.25")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v(" asyncio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CancelledError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"User closed connection"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"ビルトイン信号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ビルトイン信号"}},[t._v("#")]),t._v(" ビルトイン信号")]),t._v(" "),s("p",[t._v("バージョン "),s("RouterLink",{attrs:{to:"/ja/guide/release-notes/v21.3.html"}},[t._v("21.3")]),t._v(" で "),s("RouterLink",{attrs:{to:"/ja/guide/advanced/signals.html"}},[t._v("signals")]),t._v(" が導入されました。現在、Sanicは"),s("strong",[t._v("コードベース自体から")]),t._v("シグナルイベントをディスパッチします。これは、開発者が以前よりもはるかに近いレベルでリクエスト/レスポンスサイクルにフックする能力を持っていることを意味します。")],1),t._v(" "),s("p",[t._v("これまでは、何らかのロジックを注入しようとすると、ミドルウェアに限られていたのです。統合シグナルは「スーパーミドルウェア」だと考えてください。現在ディスパッチされるイベントは以下の通りです。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("http.lifecycle.begin")])]),t._v(" "),s("li",[s("code",[t._v("http.lifecycle.complete")])]),t._v(" "),s("li",[s("code",[t._v("http.lifecycle.exception")])]),t._v(" "),s("li",[s("code",[t._v("http.lifecycle.handle")])]),t._v(" "),s("li",[s("code",[t._v("http.lifecycle.read_body")])]),t._v(" "),s("li",[s("code",[t._v("http.lifecycle.read_head")])]),t._v(" "),s("li",[s("code",[t._v("http.lifecycle.request")])]),t._v(" "),s("li",[s("code",[t._v("http.lifecycle.response")])]),t._v(" "),s("li",[s("code",[t._v("http.lifecycle.send")])]),t._v(" "),s("li",[s("code",[t._v("http.middleware.after")])]),t._v(" "),s("li",[s("code",[t._v("http.middleware.before")])]),t._v(" "),s("li",[s("code",[t._v("http.routing.after")])]),t._v(" "),s("li",[s("code",[t._v("http.routing.before")])]),t._v(" "),s("li",[s("code",[t._v("server.init.after")])]),t._v(" "),s("li",[s("code",[t._v("server.init.before")])]),t._v(" "),s("li",[s("code",[t._v("server.shutdown.after")])]),t._v(" "),s("li",[s("code",[t._v("server.shutdown.before")])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),s("p",[s("code",[t._v("server")]),t._v("シグナルは、4つのメインサーバリスナーイベントと同じです。実際、これらのリスナーはシグナルを実装するための便利なラッパーに過ぎません。")])]),t._v(" "),s("h3",{attrs:{id:"より賢い自動例外フォーマット"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#より賢い自動例外フォーマット"}},[t._v("#")]),t._v(" より賢い"),s("code",[t._v("自動")]),t._v("例外フォーマット")]),t._v(" "),s("p",[t._v("Sanicは現在、エンドポイントとクライアントに基づいた適切な例外フォーマットで応答しようとします。たとえば、エンドポイントが常に "),s("code",[t._v("sanic.response.json")]),t._v(" オブジェクトを返す場合、例外はすべて自動的に JSON でフォーマットされます。同じことが、 "),s("code",[t._v("text")]),t._v(" と "),s("code",[t._v("html")]),t._v(" のレスポンスにも当てはまります。")]),t._v(" "),s("p",[t._v("さらに、ルート定義により、ルートごとに使用するフォーマッターを_明示的に_制御できるようになりました。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error_format"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"json"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),s("h3",{attrs:{id:"ブループリントのコピー"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ブループリントのコピー"}},[t._v("#")]),t._v(" ブループリントのコピー")]),t._v(" "),s("p",[t._v("ブループリントは、新しいインスタンスにコピーすることができます。これは、ルートやミドルウェアなど、それに付随するすべてのものを引き継ぎます。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("v1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Blueprint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Version1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/something"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("something")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\nv2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("copy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Version2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("blueprint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("blueprint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/v1/something\n/v2/something\n")])])]),s("h3",{attrs:{id:"ブループリントグループの便利なメソッド"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ブループリントグループの便利なメソッド"}},[t._v("#")]),t._v(" ブループリントグループの便利なメソッド")]),t._v(" "),s("p",[t._v("ブループリントグループは、通常のブループリントと同じすべてのメソッドを使用できるようになりました。これにより、ブループリントのコピーと合わせて、ブループリントは非常にコンポーザブルで柔軟なものになるはずです。")]),t._v(" "),s("h3",{attrs:{id:"acceptヘッダーの解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#acceptヘッダーの解析"}},[t._v("#")]),t._v(" Acceptヘッダーの解析")]),t._v(" "),s("p",[t._v("Sanicの"),s("code",[t._v("Request")]),t._v("オブジェクトは "),s("code",[t._v("Accept")]),t._v(" ヘッダーをパースして、クライアントの content-type の優先順位のリストを提供することができます。単純にアクセッサとしてアクセスすることができます。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("accept"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# ["*/*"]')]),t._v("\n")])])]),s("p",[t._v("また、ワイルドカードでの照合も可能です。例えば、受信したリクエストに含まれるものとして:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Accept: */*\n")])])]),s("p",[t._v("その場合、以下は "),s("code",[t._v("True")]),t._v(" となります。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/plain"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("accept\n")])])]),s("h3",{attrs:{id:"デフォルトの例外メッセージ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#デフォルトの例外メッセージ"}},[t._v("#")]),t._v(" デフォルトの例外メッセージ")]),t._v(" "),s("p",[s("code",[t._v("SanicException")]),t._v(" から派生した例外はすべて、デフォルトの例外メッセージを定義できるようになりました。これにより、複数の場所で同じ例外を再利用する際に、例外が提供するメッセージに関するDRY問題が発生しなくなり、より便利で保守しやすくなりました。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TeaError")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SanicException"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Tempest in a teapot"')]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" TeaError\n")])])]),s("h3",{attrs:{id:"型アノテーションの利便機能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#型アノテーションの利便機能"}},[t._v("#")]),t._v(" 型アノテーションの利便機能")]),t._v(" "),s("p",[t._v("Pythonの型アノテーションを利用して、パスパラメータの型を制御することが可能になりました。次のようにする代わりに、")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/<one:int>/<two:float>/<three:uuid>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" one"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" two"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" three"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" UUID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("次のようにシンプルにできるようになりました。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/<one>/<two>/<three>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" one"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" two"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" three"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" UUID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("これらの例では、どちらも同じルーティングの原則が適用されることになります。")]),t._v(" "),s("h3",{attrs:{id:"明示的な静的リソース型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#明示的な静的リソース型"}},[t._v("#")]),t._v(" 明示的な静的リソース型")]),t._v(" "),s("p",[t._v("静的なエンドポイントに、リソースをファイルとして扱うかディレクトリとして扱うかを明示的に指示できるようになりました。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/some/file"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" resource_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"ニュース"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ニュース"}},[t._v("#")]),t._v(" ニュース")]),t._v(" "),s("h3",{attrs:{id:"sanic-ext-のリリースと-sanic-openapi-の非推奨化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sanic-ext-のリリースと-sanic-openapi-の非推奨化"}},[t._v("#")]),t._v(" "),s("code",[t._v("sanic-ext")]),t._v(" のリリースと "),s("code",[t._v("sanic-openapi")]),t._v(" の非推奨化")]),t._v(" "),s("p",[t._v("サニックの基本理念のひとつは、「独裁者ではなく、道具であること」です。このホームページのトップページにあるように、")]),t._v(" "),s("blockquote",[s("p",[t._v("ツールに制約されることなく、構築したい方法で構築。")])]),t._v(" "),s("p",[t._v("これは、（特にWeb API開発者が）使用する多くの一般的な機能が、"),s("code",[t._v("sanic")]),t._v("リポジトリに存在しないことを意味します。これには良い理由があります。独創的であることは、開発者に自由と柔軟性を与えます。")]),t._v(" "),s("p",[t._v("しかし、時には同じものをビルドしたり再構築したりする必要がないようにしたいものです。Sanicはこれまで、プラグインでギャップを埋めるために、コミュニティの素晴らしいサポートに本当に頼ってきました。")]),t._v(" "),s("p",[t._v("初期から、公式の "),s("code",[t._v("sanic-openapi")]),t._v(" パッケージがあり、アプリケーションに基づいた OpenAPI ドキュメントを作成する機能を提供していました。しかし、このプロジェクトは何年も悩まされ、メインプロジェクトほどの優先度は与えられていませんでした。")]),t._v(" "),s("p",[t._v("v21.9 のリリースから、SCOは"),s("code",[t._v("sanic-openapi")]),t._v("パッケージを非推奨とし、メンテナンスモードへ移行します。これは、現在の将来を維持するために必要なアップデートは継続されますが、新しい機能の拡張は行われないことを意味します。")]),t._v(" "),s("p",[t._v("その代わりとして、 "),s("code",[t._v("sanic-ext")]),t._v(" という新しいプロジェクトが導入されます。このパッケージは、OAS3ドキュメントを構築する機能を提供するだけでなく、API開発者がアプリケーションで必要とする多くのギャップを埋めることができます。例えば、CORSをセットアップし、必要に応じて"),s("code",[t._v("HEAD")]),t._v("と"),s("code",[t._v("OPTIONS")]),t._v("レスポンスを自動で有効にすることができます。また、標準ライブラリのデータクラスやPydanticモデルを用いて、入力されたデータを検証することができます。")]),t._v(" "),s("p",[t._v("機能一覧は以下の通りです。")]),t._v(" "),s("ul",[s("li",[t._v("CORS保護")]),t._v(" "),s("li",[t._v("受信リクエストの検証")]),t._v(" "),s("li",[t._v("RedocやSwagger UIを使った自動OAS3ドキュメント作成機能")]),t._v(" "),s("li",[t._v("自動的な "),s("code",[t._v("HEAD")]),t._v("、"),s("code",[t._v("OPTIONS")]),t._v("、"),s("code",[t._v("TRACE")]),t._v(" レスポンス")]),t._v(" "),s("li",[t._v("依存性注入")]),t._v(" "),s("li",[t._v("レスポンスシリアライゼーション")])]),t._v(" "),s("p",[t._v("このプロジェクトは今のところまだ "),s("code",[t._v("alpha")]),t._v("モードであり、変更される可能性があります。実運用に耐えうるものと考えていますが、機能追加を続ける中でAPIを変更する必要があるかもしれません。")]),t._v(" "),s("p",[t._v("詳しくは "),s("RouterLink",{attrs:{to:"/ja/plugins/sanic-ext/getting-started.html"}},[t._v("ドキュメント")]),t._v(" をご覧ください。")],1),t._v(" "),s("h2",{attrs:{id:"感謝"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#感謝"}},[t._v("#")]),t._v(" 感謝")]),t._v(" "),s("p",[t._v("今回のリリースに参加された皆様、ありがとうございました。👏")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/aaugustin",target:"_blank",rel:"noopener noreferrer"}},[t._v("@aaugustin"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ahopkins",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ahopkins"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ashleysommer",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ashleysommer"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/cansarigol3megawatt",target:"_blank",rel:"noopener noreferrer"}},[t._v("@cansarigol3megawatt"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ChihweiLHBird",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ChihweiLHBird"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/gluhar2006",target:"_blank",rel:"noopener noreferrer"}},[t._v("@gluhar2006"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/komar007",target:"_blank",rel:"noopener noreferrer"}},[t._v("@komar007"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ombe1229",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ombe1229"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/prryplatypus",target:"_blank",rel:"noopener noreferrer"}},[t._v("@prryplatypus"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/SaidBySolo",target:"_blank",rel:"noopener noreferrer"}},[t._v("@SaidBySolo"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/tronic",target:"_blank",rel:"noopener noreferrer"}},[t._v("@Tronic"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/vltr",target:"_blank",rel:"noopener noreferrer"}},[t._v("@vltr"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("そして、ドキュメントの同期と中国語への翻訳を維持してくれた"),s("a",{attrs:{href:"https://github.com/miss85246",target:"_blank",rel:"noopener noreferrer"}},[t._v("@miss85246"),s("OutboundLink")],1),t._v(" と "),s("a",{attrs:{href:"https://github.com/ZinkLu",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ZinkLu"),s("OutboundLink")],1),t._v(" には、多大なる感謝を捧げます。")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("もし、このプロジェクトを楽しんでいただけるなら、ぜひ貢献をご検討ください。もちろん、コードの貢献も大好きですが、どんな形の貢献も大歓迎です。ドキュメントを書いたり、ユースケースを見せたり、会話に参加してあなたの声を伝えたり、もし可能なら"),s("a",{attrs:{href:"https://opencollective.com/sanic-org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("金銭的貢献"),s("OutboundLink")],1),t._v("も検討してください。")])])}),[],!1,null,null,null);a.default=n.exports}}]);