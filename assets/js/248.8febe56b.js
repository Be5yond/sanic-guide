(window.webpackJsonp=window.webpackJsonp||[]).push([[248],{702:function(t,a,s){"use strict";s.r(a);var n=s(19),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"version-21-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#version-21-6"}},[t._v("#")]),t._v(" Version 21.6")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#介绍-introduction"}},[t._v("介绍(Introduction)")])]),s("li",[s("a",{attrs:{href:"#更新内容-what-to-know"}},[t._v("更新内容(What to know)")]),s("ul",[s("li",[s("a",{attrs:{href:"#弃用-streaminghttpresponse-deprecation-of-streaminghttpresponse"}},[t._v("弃用 StreamingHTTPResponse (Deprecation of StreamingHTTPResponse)")])]),s("li",[s("a",{attrs:{href:"#弃用-compositionview-deprecation-of-compositionview"}},[t._v("弃用 CompositionView(Deprecation of CompositionView)")])]),s("li",[s("a",{attrs:{href:"#弃用路径参数类型-string-和-number-deprecation-of-path-parameter-types-string-and-number"}},[t._v("弃用路径参数类型： string 和 number (Deprecation of path parameter types: string and number)")])]),s("li",[s("a",{attrs:{href:"#升级至0-7版本的路由-version-0-7-router-upgrades"}},[t._v("升级至0.7版本的路由(Version 0.7 router upgrades)")])]),s("li",[s("a",{attrs:{href:"#使用-eof-来结束流式传输-inline-streaming-with-eof"}},[t._v("使用 eof() 来结束流式传输(Inline streaming with eof())")])]),s("li",[s("a",{attrs:{href:"#新的路径参数类型-slug-new-path-parameter-type-slug"}},[t._v("新的路径参数类型 slug (New path parameter type: slug)")])]),s("li",[s("a",{attrs:{href:"#更加严格的应用蓝图名称-弃用随意的命名方式-stricter-application-and-blueprint-names-and-deprecation"}},[t._v("更加严格的应用蓝图名称，弃用随意的命名方式(Stricter application and blueprint names, and deprecation)")])]),s("li",[s("a",{attrs:{href:"#route-对象的-route-uri-新属性-a-new-access-on-route-object-route-uri"}},[t._v("Route 对象的 route.uri 新属性 (A new access on Route object: route.uri)")])]),s("li",[s("a",{attrs:{href:"#request-对象包含ip信息的新属性-a-new-accessor-on-request-object-impacting-ips"}},[t._v("Request 对象包含ip信息的新属性(A new accessor on Request object impacting IPs)")])]),s("li",[s("a",{attrs:{href:"#可选的-config-和-sanic-ctx-对象-alternate-config-and-sanic-ctx-objects"}},[t._v("可选的 Config 和 Sanic.ctx 对象 (Alternate Config and Sanic.ctx objects)")])]),s("li",[s("a",{attrs:{href:"#sanic-命令行工具改进-sanic-cli-improvements"}},[t._v("Sanic 命令行工具改进(Sanic CLI improvements)")])]),s("li",[s("a",{attrs:{href:"#版本前缀-version-prefix"}},[t._v("版本前缀(Version prefix)")])]),s("li",[s("a",{attrs:{href:"#信号事件的自动注册-signal-event-auto-registration"}},[t._v("信号事件的自动注册(Signal event auto-registration)")])]),s("li",[s("a",{attrs:{href:"#可重复利用和可嵌套的-blueprint-和-blueprintgroup-infinitely-reusable-and-nestable-blueprint-and-blueprintgroup"}},[t._v("可重复利用和可嵌套的 Blueprint 和 BlueprintGroup (Infinitely reusable and nestable Blueprint and BlueprintGroup)")])]),s("li",[s("a",{attrs:{href:"#http-方法作为-enum-http-methods-as-enum"}},[t._v("HTTP 方法作为 Enum (HTTP methods as Enum)")])]),s("li",[s("a",{attrs:{href:"#拓展-httpmethodview-expansion-of-httpmethodview"}},[t._v("拓展 HTTPMethodView (Expansion of HTTPMethodView)")])])])]),s("li",[s("a",{attrs:{href:"#新闻-news"}},[t._v("新闻(News)")]),s("ul",[s("li",[s("a",{attrs:{href:"#discord-聊天室和社区论坛-discord-and-support-forums"}},[t._v("Discord 聊天室和社区论坛 (Discord and support forums)")])]),s("li",[s("a",{attrs:{href:"#sanic-社区组织-2022-年选举-sco-2022-elections"}},[t._v("Sanic 社区组织 2022 年选举(SCO 2022 elections)")])]),s("li",[s("a",{attrs:{href:"#正在进行的新项目-new-project-underway"}},[t._v("正在进行的新项目(New project underway)")])])])]),s("li",[s("a",{attrs:{href:"#鸣谢-thank-you"}},[t._v("鸣谢(Thank you)")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"介绍-introduction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍-introduction"}},[t._v("#")]),t._v(" 介绍(Introduction)")]),t._v(" "),s("p",[t._v("这是 21 版本"),s("RouterLink",{attrs:{to:"/zh/guide/project/policies.html#release-schedule"}},[t._v("发布周期")]),t._v("内的第二次发布。我们将在 12 月份发布长期支持办，在此之前，我们还会在 9 月还会进行一次发布。值得注意的是，在 21.3 版本中，路由已经被作为依赖被移动到了单独的包中： "),s("a",{attrs:{href:"https://pypi.org/project/sanic-routing",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("sanic-routing")]),s("OutboundLink")],1),t._v("。这一变化可能会暂时保留。从这个版本开始，路由最低要求的版本是0.7.0。")],1),t._v(" "),s("h2",{attrs:{id:"更新内容-what-to-know"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新内容-what-to-know"}},[t._v("#")]),t._v(" 更新内容(What to know)")]),t._v(" "),s("p",[t._v("更多细节详见"),s("a",{attrs:{href:"https://sanic.readthedocs.io/en/stable/sanic/changelog.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("发布说明"),s("OutboundLink")],1),t._v("。以下是值得注意的新功能或突破性变化，以及更新内容...")]),t._v(" "),s("h3",{attrs:{id:"弃用-streaminghttpresponse-deprecation-of-streaminghttpresponse"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#弃用-streaminghttpresponse-deprecation-of-streaminghttpresponse"}},[t._v("#")]),t._v(" 弃用 "),s("code",[t._v("StreamingHTTPResponse")]),t._v(" (Deprecation of "),s("code",[t._v("StreamingHTTPResponse")]),t._v(")")]),t._v(" "),s("p",[s("code",[t._v("StreamingHTTPResponse")]),t._v(" 已经被弃用，并将在 21.12 版本中删除。这将影响 "),s("code",[t._v("sanic.response.stream")]),t._v(" 和 "),s("code",[t._v("sanic.response.file_stream")]),t._v(" 方法，它们都依赖 "),s("code",[t._v("StreamingHTTPResponse")]),t._v(" 对象。")]),t._v(" "),s("p",[t._v("尽管确切的迁移路线还没有确认，但是 "),s("code",[t._v("sanic.response.stream")]),t._v(" 和 "),s("code",[t._v("sanic.response.file_stream")]),t._v(" 将继续以某种便捷操作的形式继续存在于 v21.12 中。我们希望经历一个夏天的讨论，在 9 月的发布前确定更多细节。")]),t._v(" "),s("h3",{attrs:{id:"弃用-compositionview-deprecation-of-compositionview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#弃用-compositionview-deprecation-of-compositionview"}},[t._v("#")]),t._v(" 弃用 "),s("code",[t._v("CompositionView")]),t._v("(Deprecation of "),s("code",[t._v("CompositionView")]),t._v(")")]),t._v(" "),s("p",[s("code",[t._v("CompositionView")]),t._v(" 已经被弃用，并且将在 21.12 版本中删除。")]),t._v(" "),s("h3",{attrs:{id:"弃用路径参数类型-string-和-number-deprecation-of-path-parameter-types-string-and-number"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#弃用路径参数类型-string-和-number-deprecation-of-path-parameter-types-string-and-number"}},[t._v("#")]),t._v(" 弃用路径参数类型： "),s("code",[t._v("string")]),t._v(" 和 "),s("code",[t._v("number")]),t._v(" (Deprecation of path parameter types: "),s("code",[t._v("string")]),t._v(" and "),s("code",[t._v("number")]),t._v(")")]),t._v(" "),s("p",[t._v("今后，您应该使用 "),s("code",[t._v("str")]),t._v(" 和 "),s("code",[t._v("float")]),t._v(" 作为路径参数类型来替代原先的 "),s("code",[t._v("string")]),t._v(" 和 "),s("code",[t._v("number")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/<foo:str>/<bar:float>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("现有的 "),s("code",[t._v("string")]),t._v(" 和 "),s("code",[t._v("number")]),t._v(" 类型将作为新类型的别名，但将在v21.12中被删除。")]),t._v(" "),s("h3",{attrs:{id:"升级至0-7版本的路由-version-0-7-router-upgrades"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#升级至0-7版本的路由-version-0-7-router-upgrades"}},[t._v("#")]),t._v(" 升级至0.7版本的路由(Version 0.7 router upgrades)")]),t._v(" "),s("p",[t._v("在0.7版本中，修复了一些列 bug，并且相比 0.6 版本，新版本能优雅地处理更多的边缘情况。如果您遇到任何不支持的路由模式，请"),s("a",{attrs:{href:"https://github.com/sanic-org/sanic-routing/issues",target:"_blank",rel:"noopener noreferrer"}},[t._v("在这里反馈"),s("OutboundLink")],1),t._v("。您可以在 "),s("code",[t._v("sanic-routing")]),t._v(" "),s("a",{attrs:{href:"https://github.com/sanic-org/sanic-routing/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("发布说明"),s("OutboundLink")],1),t._v("中看到一些问题的解决。")]),t._v(" "),s("h3",{attrs:{id:"使用-eof-来结束流式传输-inline-streaming-with-eof"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-eof-来结束流式传输-inline-streaming-with-eof"}},[t._v("#")]),t._v(" 使用 "),s("code",[t._v("eof()")]),t._v(" 来结束流式传输(Inline streaming with "),s("code",[t._v("eof()")]),t._v(")")]),t._v(" "),s("p",[t._v("我们在 21.3 中对处理流式传输进行了"),s("a",{attrs:{href:"https://sanic.dev/zh/guide/release-notes/v21.3.html#%E6%9B%B4%E6%96%B0%E5%86%85%E5%AE%B9-what-to-know",target:"_blank",rel:"noopener noreferrer"}},[t._v("重大变更"),s("OutboundLink")],1),t._v("，并且提供了新的串流方式。为了提供进一步的便利，我们在 21.6 中加入了一个新的 "),s("code",[t._v("response.eof()")]),t._v(" 方法来结串流。一旦所有的数据被推送到客户端，就该调用该方法。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("respond"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("content_type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/csv"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo,"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eof"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response\n")])])]),s("h3",{attrs:{id:"新的路径参数类型-slug-new-path-parameter-type-slug"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#新的路径参数类型-slug-new-path-parameter-type-slug"}},[t._v("#")]),t._v(" 新的路径参数类型 "),s("code",[t._v("slug")]),t._v(" (New path parameter type: "),s("code",[t._v("slug")]),t._v(")")]),t._v(" "),s("p",[t._v("您现在可以使用 "),s("code",[t._v("slug")]),t._v(" 类型来指定一段动态的路径并进行适当的匹配。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/articles/<article_slug:slug>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("article")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" article_slug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[s("code",[t._v("slug")]),t._v(" 必须由小写字母或数字组成。它可以包含多个连字符（"),s("code",[t._v("-")]),t._v("），但它不能放在开头。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("this-is-a-slug\nwith-123-is-also-a-slug\n111-at-start-is-a-slug\nNOT-a-slug\n-NOT-a-slug\n")])])]),s("h3",{attrs:{id:"更加严格的应用蓝图名称-弃用随意的命名方式-stricter-application-and-blueprint-names-and-deprecation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更加严格的应用蓝图名称-弃用随意的命名方式-stricter-application-and-blueprint-names-and-deprecation"}},[t._v("#")]),t._v(" 更加严格的应用蓝图名称，弃用随意的命名方式(Stricter application and blueprint names, and deprecation)")]),t._v(" "),s("p",[t._v("您的应用和蓝图实例必须符合一套更严格命名的要求。")]),t._v(" "),s("ol",[s("li",[t._v("只能由字母数字字符组成")]),t._v(" "),s("li",[t._v("可以包含一个连字符（"),s("code",[t._v("-")]),t._v("）或下划线（"),s("code",[t._v("_")]),t._v("）")]),t._v(" "),s("li",[t._v("必须以一个字母开头（大写或小写）")])]),t._v(" "),s("p",[t._v("这样的命名规则类似于 Python 的变量命名规则，但增加了允许连字符（"),s("code",[t._v("-")]),t._v("）。")]),t._v(" "),s("p",[t._v("较随意的命名标准已被废除。从 21.12 开始，不符合标准的名称将会导致一个运行时的错误。")]),t._v(" "),s("h3",{attrs:{id:"route-对象的-route-uri-新属性-a-new-access-on-route-object-route-uri"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#route-对象的-route-uri-新属性-a-new-access-on-route-object-route-uri"}},[t._v("#")]),t._v(" "),s("code",[t._v("Route")]),t._v(" 对象的 "),s("code",[t._v("route.uri")]),t._v(" 新属性 (A new access on "),s("code",[t._v("Route")]),t._v(" object: "),s("code",[t._v("route.uri")]),t._v(")")]),t._v(" "),s("p",[t._v("v21.3 中的 "),s("code",[t._v("Route")]),t._v(" 对象不再有 "),s("code",[t._v("uri")]),t._v(" 属性。取而代之的是 "),s("code",[t._v("route.path")]),t._v(" 。然而，由于 "),s("code",[t._v("sanic-routing")]),t._v(" 的工作方式，"),s("code",[t._v("path")]),t._v(" 属性 "),s("em",[t._v("不能")]),t._v(" 再以斜杠 "),s("code",[t._v("/")]),t._v(" 开头。所以现在设置以斜杠开头的 "),s("code",[t._v("route.uri")]),t._v(" 属性来作为补充。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("uri "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"/')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),t._v("\n")])])]),s("h3",{attrs:{id:"request-对象包含ip信息的新属性-a-new-accessor-on-request-object-impacting-ips"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-对象包含ip信息的新属性-a-new-accessor-on-request-object-impacting-ips"}},[t._v("#")]),t._v(" "),s("code",[t._v("Request")]),t._v(" 对象包含ip信息的新属性(A new accessor on "),s("code",[t._v("Request")]),t._v(" object impacting IPs)")]),t._v(" "),s("p",[t._v("Request 对象上有一个 "),s("code",[t._v("request.ip")]),t._v(" 属性能很方便地获取请求的 IP 信息。这个属性值来自另一个包含了更多 HTTP 连接细节的底层对象："),s("code",[t._v("request.conn_info")]),t._v(" 。")]),t._v(" "),s("p",[t._v("目前的版本为 "),s("code",[t._v("conn_info")]),t._v(" 对象增加了一个新的 "),s("code",[t._v("client_ip")]),t._v(" 属性。对于 IPv4 ，您不会注意到有什么不同。然而，对于 IPv6 的应用，新的属性将提供一个“无包装”的地址版本。请看下面的例子：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" json"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"request.ip"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"request.conn_info.client"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conn_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"request.conn_info.client_ip"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("conn_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client_ip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sock"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("my_ipv6_sock"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" http://"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("::1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":8000\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"request.ip"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"::1"')]),t._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"request.conn_info.client"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[::1]"')]),t._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"request.conn_info.client_ip"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"::1"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"可选的-config-和-sanic-ctx-对象-alternate-config-and-sanic-ctx-objects"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#可选的-config-和-sanic-ctx-对象-alternate-config-and-sanic-ctx-objects"}},[t._v("#")]),t._v(" 可选的 "),s("code",[t._v("Config")]),t._v(" 和 "),s("code",[t._v("Sanic.ctx")]),t._v(" 对象 (Alternate "),s("code",[t._v("Config")]),t._v(" and "),s("code",[t._v("Sanic.ctx")]),t._v(" objects)")]),t._v(" "),s("p",[t._v("您现在可以为 Sanic 应用传入自定义的配置和上下文对象。自定义的配置"),s("em",[t._v("应该")]),t._v("是 "),s("code",[t._v("sanic.config.Config")]),t._v(" 的子类。上下文则可以被设置为任何对象，没有限制。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nconfig "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"custom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("isinstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CustomConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("和：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nctx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"custom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("assert")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("isinstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CustomContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"sanic-命令行工具改进-sanic-cli-improvements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sanic-命令行工具改进-sanic-cli-improvements"}},[t._v("#")]),t._v(" Sanic 命令行工具改进(Sanic CLI improvements)")]),t._v(" "),s("ol",[s("li",[t._v("现有功能新标志："),s("code",[t._v("--auto-reload")])]),t._v(" "),s("li",[t._v("现有参数的的新缩写标志")]),t._v(" "),s("li",[t._v("新功能："),s("code",[t._v("--factory")])]),t._v(" "),s("li",[t._v("新功能："),s("code",[t._v("--simple")])]),t._v(" "),s("li",[t._v("新功能："),s("code",[t._v("--reload-dir")])])]),t._v(" "),s("h4",{attrs:{id:"工厂应用-factory-applications"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#工厂应用-factory-applications"}},[t._v("#")]),t._v(" 工厂应用(Factory applications)")]),t._v(" "),s("p",[t._v("对于遵循工厂模式（一个返回 "),s("code",[t._v("sanic.Sanic")]),t._v(" 实例的函数）的应用程序，您可以在 Sanic 命令行工具中添加 "),s("code",[t._v("--factory")]),t._v(" 标志来启动它。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Blueprint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Sanic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" text\n\nbp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Blueprint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__file__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@bp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"😎"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Sanic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Sanic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__file__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("blueprint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" app\n")])])]),s("p",[t._v("您可以使用如下命令来启动：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ sanic path.to:create_app --factory \n")])])]),s("h4",{attrs:{id:"简易服务器-sanic-simple-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简易服务器-sanic-simple-server"}},[t._v("#")]),t._v(" 简易服务器(Sanic Simple Server)")]),t._v(" "),s("p",[t._v("Sanic 命令行工具现在添加了简易模式的命令，它将启动一个 Sanic 服务并代理指定目录下的静态文件，同时也会在第一级目录中自动寻找 "),s("code",[t._v("index.html")]),t._v(" 文件。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$ sanic ./path/to/dir --simple\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("该功能目前仍处于早期测试阶段。可能会在今后的版本中更改。")])]),t._v(" "),s("h4",{attrs:{id:"指定额外的重启监听目录-additional-reload-directories"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定额外的重启监听目录-additional-reload-directories"}},[t._v("#")]),t._v(" 指定额外的重启监听目录(Additional reload directories)")]),t._v(" "),s("p",[t._v("当使用 "),s("code",[t._v("debug")]),t._v(" 或者是 "),s("code",[t._v("auto-reload")]),t._v(" 时，您可以指定额外的目录来确保这些目录中的文件发生变动时重启 Sanic 应用。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("sanic "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". --reload-dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/path/to/foo --reload-dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/path/to/bar\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("您"),s("em",[t._v("不需要")]),t._v("指定应用所在的目录。Sanic 将会自动的检测应用目录下 Python 文件的变化并重启。您应该使用 "),s("code",[t._v("reload-dir")]),t._v(" 参数来指定其他您关心的静态文件，并且在这些文件变化时通知应用重启。")])]),t._v(" "),s("h3",{attrs:{id:"版本前缀-version-prefix"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#版本前缀-version-prefix"}},[t._v("#")]),t._v(" 版本前缀(Version prefix)")]),t._v(" "),s("p",[t._v("当使用了 "),s("code",[t._v("version")]),t._v(" 参数时，您的路由会自动添加 "),s("code",[t._v("/v<YOUR_VERSION_NUM>")]),t._v(" 的前缀。这并不是新的功能。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /v1/my/path")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/my/path"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("现在，您可以通过在版本信息"),s("em",[t._v("之前")]),t._v("添加额外的路径信息的方式来可以修改这个固定前缀。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /api/v1/my/path")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/my/path"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" version_prefix"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/api/v"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("code",[t._v("version_prefix")]),t._v(" 参数可以这么使用：")]),t._v(" "),s("ul",[s("li",[t._v("使用 "),s("code",[t._v("app.route")]),t._v(" 和 "),s("code",[t._v("bp.route")]),t._v(" 装饰器（以及所有其他装饰器）时")]),t._v(" "),s("li",[t._v("创建 "),s("code",[t._v("Blueprint")]),t._v(" 对象时")]),t._v(" "),s("li",[t._v("调用 "),s("code",[t._v("Blueprint.group")]),t._v(" 函数时")]),t._v(" "),s("li",[t._v("创建 "),s("code",[t._v("BlueprintGroup")]),t._v(" 对象时")]),t._v(" "),s("li",[t._v("使用 "),s("code",[t._v("app.blueprint")]),t._v(" 注册蓝图时")])]),t._v(" "),s("h3",{attrs:{id:"信号事件的自动注册-signal-event-auto-registration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#信号事件的自动注册-signal-event-auto-registration"}},[t._v("#")]),t._v(" 信号事件的自动注册(Signal event auto-registration)")]),t._v(" "),s("p",[t._v("将配置项 "),s("code",[t._v("config.EVENT_AUTOREGISTER")]),t._v(" 设置为 "),s("code",[t._v("True")]),t._v(" 时将允许您等待任何的信号事件，即使这些信号没有被注册到一个响应函数上。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("signal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"do.something.start"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("signal_handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" do_something"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dispatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"do.something.complete"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# somethere else in your app:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"do.something.complete"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"可重复利用和可嵌套的-blueprint-和-blueprintgroup-infinitely-reusable-and-nestable-blueprint-and-blueprintgroup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#可重复利用和可嵌套的-blueprint-和-blueprintgroup-infinitely-reusable-and-nestable-blueprint-and-blueprintgroup"}},[t._v("#")]),t._v(" 可重复利用和可嵌套的 "),s("code",[t._v("Blueprint")]),t._v(" 和 "),s("code",[t._v("BlueprintGroup")]),t._v(" (Infinitely reusable and nestable "),s("code",[t._v("Blueprint")]),t._v(" and "),s("code",[t._v("BlueprintGroup")]),t._v(")")]),t._v(" "),s("p",[t._v("单独的 "),s("code",[t._v("Blueprint")]),t._v(" 可能不会被多个蓝图组重复注册。但是蓝图组本身可以被循环嵌套至一个或多个其他组。这将消除了蓝图组构成方式的限制。")]),t._v(" "),s("h3",{attrs:{id:"http-方法作为-enum-http-methods-as-enum"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-方法作为-enum-http-methods-as-enum"}},[t._v("#")]),t._v(" HTTP 方法作为 "),s("code",[t._v("Enum")]),t._v(" (HTTP methods as "),s("code",[t._v("Enum")]),t._v(")")]),t._v(" "),s("p",[t._v("Sanic 现在设置了 "),s("code",[t._v("sanic.HTTPMethod")]),t._v(" 的 "),s("code",[t._v("Enum")]),t._v(" 枚举对象。它可以与字符串交替使用。")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Sanic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" HTTPMethod\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PUT"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" HTTPMethod"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PATCH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("h3",{attrs:{id:"拓展-httpmethodview-expansion-of-httpmethodview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#拓展-httpmethodview-expansion-of-httpmethodview"}},[t._v("#")]),t._v(" 拓展 "),s("code",[t._v("HTTPMethodView")]),t._v(" (Expansion of "),s("code",[t._v("HTTPMethodView")]),t._v(")")]),t._v(" "),s("p",[t._v("基于类的视图现在拥有以下三种关联app的方式：")]),t._v(" "),s("p",[s("strong",[t._v("方式1 - 现有的")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DummyView")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTTPMethodView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DummyView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("as_view"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/dummy"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("方式2 - 使用 "),s("code",[t._v("attach")]),t._v(" 方法关联")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DummyView")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTTPMethodView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nDummyView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("方式3 - 定义类时使用 "),s("code",[t._v("__init_subclass__")]),t._v(" 方法关联")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DummyView")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTTPMethodView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" attach"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uri"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("如果您您的视图定义在其他文件中，方式2和方式3将会比较有用：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sanic "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Sanic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" HTTPMethodView\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DummyView")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTTPMethodView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" attach"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Sanic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uri"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("h2",{attrs:{id:"新闻-news"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#新闻-news"}},[t._v("#")]),t._v(" 新闻(News)")]),t._v(" "),s("h3",{attrs:{id:"discord-聊天室和社区论坛-discord-and-support-forums"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#discord-聊天室和社区论坛-discord-and-support-forums"}},[t._v("#")]),t._v(" Discord 聊天室和社区论坛 (Discord and support forums)")]),t._v(" "),s("p",[t._v("如果您还没有加入我们的社区，您可以通过加入"),s("a",{attrs:{href:"https://discord.gg/FARQzAEMAA",target:"_blank",rel:"noopener noreferrer"}},[t._v("Discord服务器"),s("OutboundLink")],1),t._v("和"),s("a",{attrs:{href:"https://community.sanicframework.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("社区论坛"),s("OutboundLink")],1),t._v("来参与社区讨论。此外，别忘了在Twitter上关注"),s("a",{attrs:{href:"https://twitter.com/sanicframework",target:"_blank",rel:"noopener noreferrer"}},[t._v("@sanicframework"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"sanic-社区组织-2022-年选举-sco-2022-elections"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sanic-社区组织-2022-年选举-sco-2022-elections"}},[t._v("#")]),t._v(" Sanic 社区组织 2022 年选举(SCO 2022 elections)")]),t._v(" "),s("p",[t._v("这个 夏天🏝 / 冬天❄️（根据您所在的半球）即将来临。这意味着我们将举行 Sanic 社区组织的选举。今年，我们将有以下职位需要填补：")]),t._v(" "),s("ul",[s("li",[t._v("指导委员会成员 （任期2年）")]),t._v(" "),s("li",[t._v("指导委员会成员（任期2年）")]),t._v(" "),s("li",[t._v("指导委员会成员（任期1年）")]),t._v(" "),s("li",[t._v("v22版本发布经理")]),t._v(" "),s("li",[t._v("v22版本发布经理")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/vltr",target:"_blank",rel:"noopener noreferrer"}},[t._v("@vltr"),s("OutboundLink")],1),t._v(" 将继续担任指导委员会，完成他第二年的工作。")]),t._v(" "),s("p",[t._v("如果您有兴趣了解更多信息，您可以阅读有关 SCO "),s("RouterLink",{attrs:{to:"/zh/guide/project/scope.html#角色与责任-roles-and-responsibilities"}},[t._v("角色和责任")]),t._v(" 或在 Discord 上的找 Adam Hopkins 了解详细情况。")],1),t._v(" "),s("p",[t._v("提名将于 9 月 1 日开始。随着选举的来临，更多的信息将在论坛上发布。")]),t._v(" "),s("h3",{attrs:{id:"正在进行的新项目-new-project-underway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#正在进行的新项目-new-project-underway"}},[t._v("#")]),t._v(" 正在进行的新项目(New project underway)")]),t._v(" "),s("p",[t._v("我们在 SCO 的名下增加了一个新项目："),s("a",{attrs:{href:"https://github.com/sanic-org/sanic-ext",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("sanic-ext")]),s("OutboundLink")],1),t._v("。该项目尚未发布，并处于积极开发中。这个项目的目标是最终取代"),s("a",{attrs:{href:"https://github.com/sanic-org/sanic-openapi",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("sanic-openapi")]),s("OutboundLink")],1),t._v("，为 Web 应用开发者提供更多的功能，包括参数校验、CORS 和 HTTP自动响应。如果您有兴趣帮忙，请在 Discord 上告诉我们。我们希望在 9 月份的发布之前看到该项目的初始版本。")]),t._v(" "),s("h2",{attrs:{id:"鸣谢-thank-you"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#鸣谢-thank-you"}},[t._v("#")]),t._v(" 鸣谢(Thank you)")]),t._v(" "),s("p",[t._v("感谢所有参与本次发布的人：👏")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/aaugustin",target:"_blank",rel:"noopener noreferrer"}},[t._v("@aaugustin"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ahopkins",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ahopkins"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ajaygupta2790",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ajaygupta2790"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ashleysommer",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ashleysommer"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/ent8r",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ENT8R"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/fredlllll",target:"_blank",rel:"noopener noreferrer"}},[t._v("@fredlllll"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/graingert",target:"_blank",rel:"noopener noreferrer"}},[t._v("@graingert"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/harshanarayana",target:"_blank",rel:"noopener noreferrer"}},[t._v("@harshanarayana"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/jdraymon",target:"_blank",rel:"noopener noreferrer"}},[t._v("@jdraymon"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/kyle-verhoog",target:"_blank",rel:"noopener noreferrer"}},[t._v("@Kyle-Verhoog"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/sanjeevanahilan",target:"_blank",rel:"noopener noreferrer"}},[t._v("@sanjeevanahilan"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/sjsadowski",target:"_blank",rel:"noopener noreferrer"}},[t._v("@sjsadowski"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/tronic",target:"_blank",rel:"noopener noreferrer"}},[t._v("@Tronic"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/vltr",target:"_blank",rel:"noopener noreferrer"}},[t._v("@vltr"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/zinklu",target:"_blank",rel:"noopener noreferrer"}},[t._v("@ZinkLu"),s("OutboundLink")],1)]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("如果您喜欢本项目，请考虑参与建设本项目。我们欢迎您提交代码，也欢迎您以任何其他方式来参与本项目的建设。比如撰写文档，分享使用心得，参与社区讨论，当然，如果经济允许，您也可以考虑"),s("a",{attrs:{href:"https://opencollective.com/sanic-org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("经济资助"),s("OutboundLink")],1),t._v("。")])])}),[],!1,null,null,null);a.default=e.exports}}]);