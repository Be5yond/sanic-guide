<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dependency Injection | Sanic Framework</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#fd0d68">
    <meta name="description" content="Sanic is a Python 3.7+ web server and web framework that&#39;s written to go fast. It allows the usage of the async/await syntax added in Python 3.5, which makes your code non-blocking and speedy.">
    <meta property="article:modified_time" content="2023-02-15T18:55:28.000Z">
    <meta property="og:title" content="Dependency Injection">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/en/plugins/sanic-ext/injection.html">
    <meta property="og:image" content="/images/sanic-framework-social-media-preview-1280x640.png">
    <meta name="twitter:title" content="Dependency Injection">
    <meta name="twitter:url" content="/en/plugins/sanic-ext/injection.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/images/sanic-framework-social-media-preview-1280x640.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Sanic Community Organization">
    <meta name="twitter:creator" content="@sanicframework">
    <meta name="msapplication-TileColor" content="#444444">
    <meta name="theme-color" content="#fd0d68">
    <link rel="preload" href="/assets/css/0.styles.78d15c6b.css" as="style"><link rel="preload" href="/assets/js/app.7fc9e08c.js" as="script"><link rel="preload" href="/assets/js/5.2e6dc6df.js" as="script"><link rel="preload" href="/assets/js/1.1d605411.js" as="script"><link rel="preload" href="/assets/js/103.0f1c399f.js" as="script"><link rel="prefetch" href="/assets/js/10.290705fb.js"><link rel="prefetch" href="/assets/js/100.1660adf4.js"><link rel="prefetch" href="/assets/js/101.08c37890.js"><link rel="prefetch" href="/assets/js/102.9f595aa2.js"><link rel="prefetch" href="/assets/js/104.aaad227f.js"><link rel="prefetch" href="/assets/js/105.2590fe3e.js"><link rel="prefetch" href="/assets/js/106.8980e531.js"><link rel="prefetch" href="/assets/js/107.5020432e.js"><link rel="prefetch" href="/assets/js/108.edcc6279.js"><link rel="prefetch" href="/assets/js/109.0803a39f.js"><link rel="prefetch" href="/assets/js/11.b0689255.js"><link rel="prefetch" href="/assets/js/110.2dbdd72c.js"><link rel="prefetch" href="/assets/js/111.71015ddc.js"><link rel="prefetch" href="/assets/js/112.145e4a68.js"><link rel="prefetch" href="/assets/js/113.12cdf1c5.js"><link rel="prefetch" href="/assets/js/114.06059cee.js"><link rel="prefetch" href="/assets/js/115.0d661f07.js"><link rel="prefetch" href="/assets/js/116.9359d423.js"><link rel="prefetch" href="/assets/js/117.f63b259d.js"><link rel="prefetch" href="/assets/js/118.d6806e38.js"><link rel="prefetch" href="/assets/js/119.0879fd0d.js"><link rel="prefetch" href="/assets/js/12.8f265f87.js"><link rel="prefetch" href="/assets/js/120.ac3aa533.js"><link rel="prefetch" href="/assets/js/121.c924ee79.js"><link rel="prefetch" href="/assets/js/122.e2d44bba.js"><link rel="prefetch" href="/assets/js/123.d3848f32.js"><link rel="prefetch" href="/assets/js/124.07ad326b.js"><link rel="prefetch" href="/assets/js/125.7157eecc.js"><link rel="prefetch" href="/assets/js/126.caecb96f.js"><link rel="prefetch" href="/assets/js/127.c202c67c.js"><link rel="prefetch" href="/assets/js/128.18ea4dec.js"><link rel="prefetch" href="/assets/js/129.798cf7e1.js"><link rel="prefetch" href="/assets/js/13.7e21f362.js"><link rel="prefetch" href="/assets/js/130.f799d21c.js"><link rel="prefetch" href="/assets/js/131.3153b212.js"><link rel="prefetch" href="/assets/js/132.69d89994.js"><link rel="prefetch" href="/assets/js/133.24ba8d28.js"><link rel="prefetch" href="/assets/js/134.75cac0bc.js"><link rel="prefetch" href="/assets/js/135.b48253d9.js"><link rel="prefetch" href="/assets/js/136.52d51e9a.js"><link rel="prefetch" href="/assets/js/137.1bed7821.js"><link rel="prefetch" href="/assets/js/138.6df2e4b9.js"><link rel="prefetch" href="/assets/js/139.c65f149b.js"><link rel="prefetch" href="/assets/js/14.7e9ad080.js"><link rel="prefetch" href="/assets/js/140.ab5d46de.js"><link rel="prefetch" href="/assets/js/141.57cd8b61.js"><link rel="prefetch" href="/assets/js/142.a9c59fbc.js"><link rel="prefetch" href="/assets/js/143.27105180.js"><link rel="prefetch" href="/assets/js/144.05d9d54c.js"><link rel="prefetch" href="/assets/js/145.c64e4704.js"><link rel="prefetch" href="/assets/js/146.e43c597e.js"><link rel="prefetch" href="/assets/js/147.ec971115.js"><link rel="prefetch" href="/assets/js/148.16b8b75e.js"><link rel="prefetch" href="/assets/js/149.eddb3ab1.js"><link rel="prefetch" href="/assets/js/15.f2cca1bd.js"><link rel="prefetch" href="/assets/js/150.0083e584.js"><link rel="prefetch" href="/assets/js/151.307c5dd0.js"><link rel="prefetch" href="/assets/js/152.855841fe.js"><link rel="prefetch" href="/assets/js/153.636e8fac.js"><link rel="prefetch" href="/assets/js/154.3f33d16a.js"><link rel="prefetch" href="/assets/js/155.8c48ba03.js"><link rel="prefetch" href="/assets/js/156.0815f62f.js"><link rel="prefetch" href="/assets/js/157.3ac084b0.js"><link rel="prefetch" href="/assets/js/158.d91afac8.js"><link rel="prefetch" href="/assets/js/159.9f9db1e9.js"><link rel="prefetch" href="/assets/js/16.08c99b8c.js"><link rel="prefetch" href="/assets/js/160.a0cf224d.js"><link rel="prefetch" href="/assets/js/161.bd403cbb.js"><link rel="prefetch" href="/assets/js/162.d87dae06.js"><link rel="prefetch" href="/assets/js/163.56aab8f1.js"><link rel="prefetch" href="/assets/js/164.9df4c37e.js"><link rel="prefetch" href="/assets/js/165.48b72e62.js"><link rel="prefetch" href="/assets/js/166.6dd4474f.js"><link rel="prefetch" href="/assets/js/167.431eef64.js"><link rel="prefetch" href="/assets/js/168.5b6600e6.js"><link rel="prefetch" href="/assets/js/169.1feac577.js"><link rel="prefetch" href="/assets/js/17.9c6ced40.js"><link rel="prefetch" href="/assets/js/170.5ae04bae.js"><link rel="prefetch" href="/assets/js/171.2e079f9e.js"><link rel="prefetch" href="/assets/js/172.0eb9e6b4.js"><link rel="prefetch" href="/assets/js/173.1b9a6d04.js"><link rel="prefetch" href="/assets/js/174.570950c1.js"><link rel="prefetch" href="/assets/js/175.d10d2bbb.js"><link rel="prefetch" href="/assets/js/176.a24e4149.js"><link rel="prefetch" href="/assets/js/177.3d1b24c0.js"><link rel="prefetch" href="/assets/js/178.be91a76e.js"><link rel="prefetch" href="/assets/js/179.4ea4025e.js"><link rel="prefetch" href="/assets/js/18.a35d6e6f.js"><link rel="prefetch" href="/assets/js/180.8be0b1aa.js"><link rel="prefetch" href="/assets/js/181.1add1c9f.js"><link rel="prefetch" href="/assets/js/182.17f3792a.js"><link rel="prefetch" href="/assets/js/183.ed285517.js"><link rel="prefetch" href="/assets/js/184.081ec4d2.js"><link rel="prefetch" href="/assets/js/185.bd2006eb.js"><link rel="prefetch" href="/assets/js/186.0df811d5.js"><link rel="prefetch" href="/assets/js/187.2c2aa1c8.js"><link rel="prefetch" href="/assets/js/188.aad6eba5.js"><link rel="prefetch" href="/assets/js/189.0d12d3f2.js"><link rel="prefetch" href="/assets/js/19.f5edb127.js"><link rel="prefetch" href="/assets/js/190.836ee130.js"><link rel="prefetch" href="/assets/js/191.4db9b953.js"><link rel="prefetch" href="/assets/js/192.0649f995.js"><link rel="prefetch" href="/assets/js/193.efc9e1a5.js"><link rel="prefetch" href="/assets/js/194.6fd1ffe4.js"><link rel="prefetch" href="/assets/js/195.3d553335.js"><link rel="prefetch" href="/assets/js/196.9704a059.js"><link rel="prefetch" href="/assets/js/197.e829faf0.js"><link rel="prefetch" href="/assets/js/198.5ffb32c2.js"><link rel="prefetch" href="/assets/js/199.1b7c3885.js"><link rel="prefetch" href="/assets/js/20.1dde8c8f.js"><link rel="prefetch" href="/assets/js/200.30b9b111.js"><link rel="prefetch" href="/assets/js/201.bb713d7f.js"><link rel="prefetch" href="/assets/js/202.4d158f0d.js"><link rel="prefetch" href="/assets/js/203.e8af5a65.js"><link rel="prefetch" href="/assets/js/204.e648aa51.js"><link rel="prefetch" href="/assets/js/205.e4e0a724.js"><link rel="prefetch" href="/assets/js/206.9d14bae6.js"><link rel="prefetch" href="/assets/js/207.1b4064a1.js"><link rel="prefetch" href="/assets/js/208.33bc33a4.js"><link rel="prefetch" href="/assets/js/209.ee955043.js"><link rel="prefetch" href="/assets/js/21.b409c0fd.js"><link rel="prefetch" href="/assets/js/210.c5a81e89.js"><link rel="prefetch" href="/assets/js/211.a7fac830.js"><link rel="prefetch" href="/assets/js/212.a4ac85cc.js"><link rel="prefetch" href="/assets/js/213.a9675b76.js"><link rel="prefetch" href="/assets/js/214.1dcd09a3.js"><link rel="prefetch" href="/assets/js/215.7b11a689.js"><link rel="prefetch" href="/assets/js/216.50b1401c.js"><link rel="prefetch" href="/assets/js/217.21324267.js"><link rel="prefetch" href="/assets/js/218.d8ad3a0e.js"><link rel="prefetch" href="/assets/js/219.805ac6cc.js"><link rel="prefetch" href="/assets/js/22.31a9050e.js"><link rel="prefetch" href="/assets/js/220.9abb89c2.js"><link rel="prefetch" href="/assets/js/221.b79d5123.js"><link rel="prefetch" href="/assets/js/222.f3c361bc.js"><link rel="prefetch" href="/assets/js/223.7c922ab0.js"><link rel="prefetch" href="/assets/js/224.8c12ba30.js"><link rel="prefetch" href="/assets/js/225.d3e9c969.js"><link rel="prefetch" href="/assets/js/226.c18ce54b.js"><link rel="prefetch" href="/assets/js/227.75c06978.js"><link rel="prefetch" href="/assets/js/228.1d727e32.js"><link rel="prefetch" href="/assets/js/229.b6e23f89.js"><link rel="prefetch" href="/assets/js/23.5d4b3fc8.js"><link rel="prefetch" href="/assets/js/230.a063a4d9.js"><link rel="prefetch" href="/assets/js/231.1b053882.js"><link rel="prefetch" href="/assets/js/232.16e9386e.js"><link rel="prefetch" href="/assets/js/233.aa7a2e26.js"><link rel="prefetch" href="/assets/js/234.6ec268a4.js"><link rel="prefetch" href="/assets/js/235.bd1bd178.js"><link rel="prefetch" href="/assets/js/236.bea3bc61.js"><link rel="prefetch" href="/assets/js/237.8562e79f.js"><link rel="prefetch" href="/assets/js/238.8ef66235.js"><link rel="prefetch" href="/assets/js/239.2e146f17.js"><link rel="prefetch" href="/assets/js/24.73e2ca9d.js"><link rel="prefetch" href="/assets/js/240.5ff64bfb.js"><link rel="prefetch" href="/assets/js/241.1bfa10c7.js"><link rel="prefetch" href="/assets/js/242.c463e832.js"><link rel="prefetch" href="/assets/js/243.29f8070a.js"><link rel="prefetch" href="/assets/js/244.a77c8db8.js"><link rel="prefetch" href="/assets/js/245.63f1e1b0.js"><link rel="prefetch" href="/assets/js/246.7557eae8.js"><link rel="prefetch" href="/assets/js/247.fe7240c9.js"><link rel="prefetch" href="/assets/js/248.744f611c.js"><link rel="prefetch" href="/assets/js/249.c17f16a9.js"><link rel="prefetch" href="/assets/js/25.3ed222c4.js"><link rel="prefetch" href="/assets/js/250.8eecd2e8.js"><link rel="prefetch" href="/assets/js/251.0292fa7b.js"><link rel="prefetch" href="/assets/js/252.c1551048.js"><link rel="prefetch" href="/assets/js/253.867a182e.js"><link rel="prefetch" href="/assets/js/254.e8dca92d.js"><link rel="prefetch" href="/assets/js/255.9c943575.js"><link rel="prefetch" href="/assets/js/256.3c60b00c.js"><link rel="prefetch" href="/assets/js/257.5e64ca99.js"><link rel="prefetch" href="/assets/js/258.e2e30a75.js"><link rel="prefetch" href="/assets/js/259.43c95b7e.js"><link rel="prefetch" href="/assets/js/26.6b034021.js"><link rel="prefetch" href="/assets/js/260.09db733a.js"><link rel="prefetch" href="/assets/js/261.33fdafea.js"><link rel="prefetch" href="/assets/js/262.6a3cfa22.js"><link rel="prefetch" href="/assets/js/263.0d91885b.js"><link rel="prefetch" href="/assets/js/264.95b54d08.js"><link rel="prefetch" href="/assets/js/265.7990be28.js"><link rel="prefetch" href="/assets/js/266.0e7c26bc.js"><link rel="prefetch" href="/assets/js/267.835437dc.js"><link rel="prefetch" href="/assets/js/268.53ffd963.js"><link rel="prefetch" href="/assets/js/269.92615ddd.js"><link rel="prefetch" href="/assets/js/27.b706f260.js"><link rel="prefetch" href="/assets/js/270.4904c229.js"><link rel="prefetch" href="/assets/js/271.ca1dbbec.js"><link rel="prefetch" href="/assets/js/272.a724b1c8.js"><link rel="prefetch" href="/assets/js/273.822b3b48.js"><link rel="prefetch" href="/assets/js/274.1d68860d.js"><link rel="prefetch" href="/assets/js/275.4df4e682.js"><link rel="prefetch" href="/assets/js/276.ff889acb.js"><link rel="prefetch" href="/assets/js/277.a15da53b.js"><link rel="prefetch" href="/assets/js/278.3b739974.js"><link rel="prefetch" href="/assets/js/279.18b63b00.js"><link rel="prefetch" href="/assets/js/28.667e2269.js"><link rel="prefetch" href="/assets/js/280.2ecfb715.js"><link rel="prefetch" href="/assets/js/281.f5d4e4d3.js"><link rel="prefetch" href="/assets/js/282.88e3a9c6.js"><link rel="prefetch" href="/assets/js/283.e2b2ec6a.js"><link rel="prefetch" href="/assets/js/284.fb4cdc42.js"><link rel="prefetch" href="/assets/js/285.5df943b9.js"><link rel="prefetch" href="/assets/js/286.33f4f613.js"><link rel="prefetch" href="/assets/js/287.c4e0e5e4.js"><link rel="prefetch" href="/assets/js/288.1e400c0a.js"><link rel="prefetch" href="/assets/js/289.4c9e35ec.js"><link rel="prefetch" href="/assets/js/29.9c49cabd.js"><link rel="prefetch" href="/assets/js/290.c0f29f55.js"><link rel="prefetch" href="/assets/js/291.f1bca51a.js"><link rel="prefetch" href="/assets/js/292.1be0e6e7.js"><link rel="prefetch" href="/assets/js/30.533b8fd1.js"><link rel="prefetch" href="/assets/js/31.22fcaab9.js"><link rel="prefetch" href="/assets/js/32.73cfa864.js"><link rel="prefetch" href="/assets/js/33.ed2ff0bc.js"><link rel="prefetch" href="/assets/js/34.051a9a93.js"><link rel="prefetch" href="/assets/js/35.b1b9e2d2.js"><link rel="prefetch" href="/assets/js/36.56095a30.js"><link rel="prefetch" href="/assets/js/37.a1024739.js"><link rel="prefetch" href="/assets/js/38.bae6a00f.js"><link rel="prefetch" href="/assets/js/39.9044d2a2.js"><link rel="prefetch" href="/assets/js/4.6fbe0ccd.js"><link rel="prefetch" href="/assets/js/40.7d9667b9.js"><link rel="prefetch" href="/assets/js/41.8a813cca.js"><link rel="prefetch" href="/assets/js/42.5ec226fc.js"><link rel="prefetch" href="/assets/js/43.34e7b32a.js"><link rel="prefetch" href="/assets/js/44.73293d27.js"><link rel="prefetch" href="/assets/js/45.6c8cc6d5.js"><link rel="prefetch" href="/assets/js/46.a6e72056.js"><link rel="prefetch" href="/assets/js/47.38d49707.js"><link rel="prefetch" href="/assets/js/48.84a4c751.js"><link rel="prefetch" href="/assets/js/49.9ce22280.js"><link rel="prefetch" href="/assets/js/50.b0f9855a.js"><link rel="prefetch" href="/assets/js/51.2e1c313c.js"><link rel="prefetch" href="/assets/js/52.a4ec7bc3.js"><link rel="prefetch" href="/assets/js/53.2986b9e5.js"><link rel="prefetch" href="/assets/js/54.dd3d51c0.js"><link rel="prefetch" href="/assets/js/55.51fa5349.js"><link rel="prefetch" href="/assets/js/56.ef75779b.js"><link rel="prefetch" href="/assets/js/57.41242a10.js"><link rel="prefetch" href="/assets/js/58.11955861.js"><link rel="prefetch" href="/assets/js/59.794af06f.js"><link rel="prefetch" href="/assets/js/6.52de075b.js"><link rel="prefetch" href="/assets/js/60.9de90d27.js"><link rel="prefetch" href="/assets/js/61.218b813a.js"><link rel="prefetch" href="/assets/js/62.ae2d36e2.js"><link rel="prefetch" href="/assets/js/63.ec722ae5.js"><link rel="prefetch" href="/assets/js/64.4e1a048d.js"><link rel="prefetch" href="/assets/js/65.a4748d44.js"><link rel="prefetch" href="/assets/js/66.43ca821b.js"><link rel="prefetch" href="/assets/js/67.5cd9fa4b.js"><link rel="prefetch" href="/assets/js/68.ec3488c0.js"><link rel="prefetch" href="/assets/js/69.adb546f2.js"><link rel="prefetch" href="/assets/js/7.23553a4f.js"><link rel="prefetch" href="/assets/js/70.ea8d3f57.js"><link rel="prefetch" href="/assets/js/71.b880cb19.js"><link rel="prefetch" href="/assets/js/72.440f3220.js"><link rel="prefetch" href="/assets/js/73.98491f29.js"><link rel="prefetch" href="/assets/js/74.a73446c0.js"><link rel="prefetch" href="/assets/js/75.4d1b917c.js"><link rel="prefetch" href="/assets/js/76.dd68ec0e.js"><link rel="prefetch" href="/assets/js/77.e6b932c3.js"><link rel="prefetch" href="/assets/js/78.8eed39de.js"><link rel="prefetch" href="/assets/js/79.dd9acfba.js"><link rel="prefetch" href="/assets/js/8.256ef002.js"><link rel="prefetch" href="/assets/js/80.82076884.js"><link rel="prefetch" href="/assets/js/81.f5a35837.js"><link rel="prefetch" href="/assets/js/82.02fcc441.js"><link rel="prefetch" href="/assets/js/83.62064a43.js"><link rel="prefetch" href="/assets/js/84.d886f66e.js"><link rel="prefetch" href="/assets/js/85.beef5044.js"><link rel="prefetch" href="/assets/js/86.c2e71129.js"><link rel="prefetch" href="/assets/js/87.80ed3326.js"><link rel="prefetch" href="/assets/js/88.f51986aa.js"><link rel="prefetch" href="/assets/js/89.ae1a20f9.js"><link rel="prefetch" href="/assets/js/9.57756334.js"><link rel="prefetch" href="/assets/js/90.48242d65.js"><link rel="prefetch" href="/assets/js/91.c9b3a652.js"><link rel="prefetch" href="/assets/js/92.6a5657d3.js"><link rel="prefetch" href="/assets/js/93.40a7c070.js"><link rel="prefetch" href="/assets/js/94.d35c8e77.js"><link rel="prefetch" href="/assets/js/95.e1c268c0.js"><link rel="prefetch" href="/assets/js/96.db96a7f9.js"><link rel="prefetch" href="/assets/js/97.46db8dff.js"><link rel="prefetch" href="/assets/js/98.7b5998aa.js"><link rel="prefetch" href="/assets/js/99.cfc4b8f6.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.470c2853.js">
    <link rel="stylesheet" href="/assets/css/0.styles.78d15c6b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/huge-success/sanic-assets/master/png/sanic-framework-logo-simple-400x97.png" alt="Sanic Framework" class="logo"> <span class="site-name can-hide">Sanic Framework</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/en/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docs" class="dropdown-title"><span class="title">Docs</span> <span class="arrow down"></span></button> <button type="button" aria-label="Docs" class="mobile-dropdown-title"><span class="title">Docs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          User Guide
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/guide/getting-started.html" class="nav-link">
  General
</a></li><li class="dropdown-subitem"><a href="/en/guide/basics/app.html" class="nav-link">
  Basics
</a></li><li class="dropdown-subitem"><a href="/en/guide/advanced/class-based-views.html" class="nav-link">
  Advanced
</a></li><li class="dropdown-subitem"><a href="/en/guide/best-practices/blueprints.html" class="nav-link">
  Best Practices
</a></li><li class="dropdown-subitem"><a href="/en/guide/deployment/configuration.html" class="nav-link">
  Running &amp; Deploying
</a></li><li class="dropdown-subitem"><a href="/en/guide/how-to/toc.html" class="nav-link">
  How to...
</a></li><li class="dropdown-subitem"><a href="/en/guide/release-notes/v22.12.html" class="nav-link">
  Latest Release Notes
</a></li></ul></li><li class="dropdown-item"><h4>
          Official Plugins
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/plugins/sanic-ext/getting-started.html" class="nav-link">
  Sanic Extensions
</a></li><li class="dropdown-subitem"><a href="/en/plugins/sanic-testing/getting-started.html" class="nav-link">
  Sanic Testing
</a></li></ul></li><li class="dropdown-item"><h4>
          API Docs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://sanic.readthedocs.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  View API Docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          Org Docs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/org/feature_requests.html" class="nav-link">
  Feature Requests
</a></li><li class="dropdown-subitem"><a href="/en/org/policies.html" class="nav-link">
  Policies
</a></li><li class="dropdown-subitem"><a href="/en/org/scope.html" class="nav-link">
  S.C.O.P.E.
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Community" class="dropdown-title"><span class="title">Community</span> <span class="arrow down"></span></button> <button type="button" aria-label="Community" class="mobile-dropdown-title"><span class="title">Community</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://community.sanicframework.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forums
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://discord.gg/FARQzAEMAA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://twitter.com/sanicframework" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://opencollective.com/sanic-org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sponsorship
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/plugins/sanic-ext/injection.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/plugins/sanic-ext/injection.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/ja/plugins/sanic-ext/injection.html" class="nav-link">
  日本語
</a></li><li class="dropdown-item"><!----> <a href="/ko/" class="nav-link">
  한국어
</a></li></ul></div></div><div class="nav-item"><a href="/en/help.html" class="nav-link">
  Help
</a></div> <a href="https://github.com/sanic-org/sanic" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/en/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docs" class="dropdown-title"><span class="title">Docs</span> <span class="arrow down"></span></button> <button type="button" aria-label="Docs" class="mobile-dropdown-title"><span class="title">Docs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          User Guide
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/guide/getting-started.html" class="nav-link">
  General
</a></li><li class="dropdown-subitem"><a href="/en/guide/basics/app.html" class="nav-link">
  Basics
</a></li><li class="dropdown-subitem"><a href="/en/guide/advanced/class-based-views.html" class="nav-link">
  Advanced
</a></li><li class="dropdown-subitem"><a href="/en/guide/best-practices/blueprints.html" class="nav-link">
  Best Practices
</a></li><li class="dropdown-subitem"><a href="/en/guide/deployment/configuration.html" class="nav-link">
  Running &amp; Deploying
</a></li><li class="dropdown-subitem"><a href="/en/guide/how-to/toc.html" class="nav-link">
  How to...
</a></li><li class="dropdown-subitem"><a href="/en/guide/release-notes/v22.12.html" class="nav-link">
  Latest Release Notes
</a></li></ul></li><li class="dropdown-item"><h4>
          Official Plugins
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/plugins/sanic-ext/getting-started.html" class="nav-link">
  Sanic Extensions
</a></li><li class="dropdown-subitem"><a href="/en/plugins/sanic-testing/getting-started.html" class="nav-link">
  Sanic Testing
</a></li></ul></li><li class="dropdown-item"><h4>
          API Docs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://sanic.readthedocs.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  View API Docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          Org Docs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/org/feature_requests.html" class="nav-link">
  Feature Requests
</a></li><li class="dropdown-subitem"><a href="/en/org/policies.html" class="nav-link">
  Policies
</a></li><li class="dropdown-subitem"><a href="/en/org/scope.html" class="nav-link">
  S.C.O.P.E.
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Community" class="dropdown-title"><span class="title">Community</span> <span class="arrow down"></span></button> <button type="button" aria-label="Community" class="mobile-dropdown-title"><span class="title">Community</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://community.sanicframework.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forums
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://discord.gg/FARQzAEMAA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://twitter.com/sanicframework" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://opencollective.com/sanic-org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sponsorship
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/plugins/sanic-ext/injection.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/plugins/sanic-ext/injection.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/ja/plugins/sanic-ext/injection.html" class="nav-link">
  日本語
</a></li><li class="dropdown-item"><!----> <a href="/ko/" class="nav-link">
  한국어
</a></li></ul></div></div><div class="nav-item"><a href="/en/help.html" class="nav-link">
  Help
</a></div> <a href="https://github.com/sanic-org/sanic" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>User Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>General</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Basics</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Advanced</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Best Practices</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Running &amp; Deploying</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>How to...</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Plugins</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Sanic Extensions</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/plugins/sanic-ext/getting-started.html" class="sidebar-link">Getting Started</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading"><span>HTTP goodies</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading"><span>OpenAPI</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/en/plugins/sanic-ext/convenience.html" class="sidebar-link">Convenience</a></li><li><a href="/en/plugins/sanic-ext/templating.html" class="sidebar-link">Templating</a></li><li><a href="/en/plugins/sanic-ext/injection.html" aria-current="page" class="active sidebar-link">Dependency Injection</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/plugins/sanic-ext/injection.html#basic-implementation" class="sidebar-link">Basic implementation</a></li><li class="sidebar-sub-header"><a href="/en/plugins/sanic-ext/injection.html#additional-constructors" class="sidebar-link">Additional constructors</a></li><li class="sidebar-sub-header"><a href="/en/plugins/sanic-ext/injection.html#arbitrary-constructors" class="sidebar-link">Arbitrary constructors</a></li><li class="sidebar-sub-header"><a href="/en/plugins/sanic-ext/injection.html#objects-from-the-request" class="sidebar-link">Objects from the Request</a></li><li class="sidebar-sub-header"><a href="/en/plugins/sanic-ext/injection.html#injecting-services" class="sidebar-link">Injecting services</a></li><li class="sidebar-sub-header"><a href="/en/plugins/sanic-ext/injection.html#generic-types" class="sidebar-link">Generic types</a></li><li class="sidebar-sub-header"><a href="/en/plugins/sanic-ext/injection.html#configuration" class="sidebar-link">Configuration</a></li></ul></li><li><a href="/en/plugins/sanic-ext/validation.html" class="sidebar-link">Validation</a></li><li><a href="/en/plugins/sanic-ext/health-monitor.html" class="sidebar-link">Health monitor</a></li><li><a href="/en/plugins/sanic-ext/logger.html" class="sidebar-link">Background logger</a></li><li><a href="/en/plugins/sanic-ext/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/en/plugins/sanic-ext/custom.html" class="sidebar-link">Custom extensions</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Sanic Testing</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Release Notes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Organization</span> <span class="arrow right"></span></p> <!----></section></li></ul>  <div class="current">
    Current with version 22.12
  </div> <div class="current">
    Want more?
    <a href="https://sanicbook.com" target="_blank">
      sanicbook.com
      <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <p>
      Check out our
      <a href="/en/org/feature_requests.html">feature requests</a></p></div></aside> <div sidebar-items="[object Object],[object Object],[object Object],[object Object]"><main class="page"> <div class="theme-default-content content__default"><h1 id="dependency-injection"><a href="#dependency-injection" class="header-anchor">#</a> Dependency Injection</h1> <p>Dependency injection is a method to add arguments to a route handler based upon the defined function signature. Specifically, it looks at the <strong>type annotations</strong> of the arguments in the handler. This can be useful in a number of cases like:</p> <ul><li>Fetching an object based upon request headers (like the current session user)</li> <li>Recasting certain objects into a specific type</li> <li>Using the request object to prefetch data</li> <li>Auto inject services</li></ul> <p>The <code>Extend</code> instance has two basic methods on it used for dependency injection: a lower level <code>add_dependency</code>, and a higher level <code>dependency</code>.</p> <p><strong>Lower level</strong>: <code>app.ext.add_dependency(...)</code></p> <ul><li><code>type: Type,</code>: some unique class that will be the type of the oject</li> <li><code>constructor: Optional[Callable[..., Any]],</code> (OPTIONAL): a function that will return that type</li></ul> <p><strong>Higher level</strong>: <code>app.ext.dependency(...)</code></p> <ul><li><code>obj: Any</code>: any object that you would like injected</li> <li><code>name: Optional[str]</code>: some name that could alternately be used as a reference</li></ul> <p>Let's explore some use cases here.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>If you used dependency injection prior to v21.12, the lower level API method was called <code>injection</code>. It has since been renamed to <code>add_dependency</code> and starting in v21.12 <code>injection</code> is an alias for <code>add_dependency</code>. The <code>injection</code> method has been deprecated for removal in v22.6.</p></div> <h2 id="basic-implementation"><a href="#basic-implementation" class="header-anchor">#</a> Basic implementation</h2> <p>The simplest use case would be simply to recast a value.</p> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><p>This could be useful if you have a model that you want to generate based upon the matched path parameters.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">IceCream</span><span class="token punctuation">:</span>
    flavor<span class="token punctuation">:</span> <span class="token builtin">str</span>
    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>flavor<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> (Yum!)&quot;</span></span>
app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>add_dependency<span class="token punctuation">(</span>IceCream<span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/&lt;flavor:str&gt;&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">ice_cream</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> flavor<span class="token punctuation">:</span> IceCream<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> text<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;You chose: </span><span class="token interpolation"><span class="token punctuation">{</span>flavor<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>$ curl localhost:8000/chocolate
You chose Chocolate (Yum!)
</code></pre></div></div></div> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><p>This works by passing a keyword argument to the constructor of the <code>type</code> argument. The previous example is equivalent to this.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><pre class="language-python"><code>flavor <span class="token operator">=</span> IceCream<span class="token punctuation">(</span>flavor<span class="token operator">=</span><span class="token string">&quot;chocolate&quot;</span><span class="token punctuation">)</span>
</code></pre></div></div></div> <h2 id="additional-constructors"><a href="#additional-constructors" class="header-anchor">#</a> Additional constructors</h2> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><p>Sometimes you may need to also pass a constructor. This could be a function, or perhaps even a classmethod that acts as a constructor. In this example, we are creating an injection that will call <code>Person.create</code> first.</p> <p>Also important to note on this example, we are actually injecting <strong>two (2)</strong> objects! It of course does not need to be this way, but we will inject objects based upon the function signature.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">PersonID</span><span class="token punctuation">:</span>
    person_id<span class="token punctuation">:</span> <span class="token builtin">int</span>
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    person_id<span class="token punctuation">:</span> PersonID
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    age<span class="token punctuation">:</span> <span class="token builtin">int</span>
    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">,</span> person_id<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">(</span>person_id<span class="token operator">=</span>PersonID<span class="token punctuation">(</span>person_id<span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;noname&quot;</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">111</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>add_dependency<span class="token punctuation">(</span>Person<span class="token punctuation">,</span> Person<span class="token punctuation">.</span>create<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>add_dependency<span class="token punctuation">(</span>PersonID<span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/person/&lt;person_id:int&gt;&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">person_details</span><span class="token punctuation">(</span>
    request<span class="token punctuation">:</span> Request<span class="token punctuation">,</span> person_id<span class="token punctuation">:</span> PersonID<span class="token punctuation">,</span> person<span class="token punctuation">:</span> Person
<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> text<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>person_id<span class="token punctuation">}</span></span><span class="token string">\n</span><span class="token interpolation"><span class="token punctuation">{</span>person<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>$ curl localhost:8000/person/123
PersonID(person_id=123)
Person(person_id=PersonID(person_id=123), name='noname', age=111)
</code></pre></div></div></div> <p>When a <code>constructor</code> is passed to <code>ext.add_dependency</code> (like in this example) that will be called. If not, then the object will be created by calling the <code>type</code>. A couple of important things to note about passing a <code>constructor</code>:</p> <ol><li>A positional <code>request: Request</code> argument is <em>usually</em> expected. See the <code>Person.create</code> method above as an example using a <code>request</code> and <a href="#arbitrary-constructors">arbitrary constructors</a> for how to use a callable that does not require a <code>request</code>.</li> <li>All matched path parameters are injected as keyword arguments.</li> <li>Dependencies can be chained and nested. Notice how in the previous example the <code>Person</code> dataclass has a <code>PersonID</code>? That means that <code>PersonID</code> will be called first, and that value is added to the keyword arguments when calling <code>Person.create</code>.</li></ol> <h2 id="arbitrary-constructors"><a href="#arbitrary-constructors" class="header-anchor">#</a> Arbitrary constructors</h2> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><p>Sometimes you may want to construct your injectable <em>without</em> the <code>Request</code> object. This is useful if you have arbitrary classes or functions that create your objects. If the callable does have any required arguments, then they should themselves be injectable objects.</p> <p>This is very useful if you have services or other types of objects that should only exist for the lifetime of a single request. For example, you might use this pattern to pull a single connection from your database pool.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Alpha</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">class</span> <span class="token class-name">Beta</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> alpha<span class="token punctuation">:</span> Alpha<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>alpha <span class="token operator">=</span> alpha
app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>add_dependency<span class="token punctuation">(</span>Alpha<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>add_dependency<span class="token punctuation">(</span>Beta<span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/beta&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">handler</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span> Request<span class="token punctuation">,</span> beta<span class="token punctuation">:</span> Beta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>beta<span class="token punctuation">.</span>alpha<span class="token punctuation">,</span> Alpha<span class="token punctuation">)</span>
</code></pre></div></div></div> <p><em>Added in v22.9</em></p> <h2 id="objects-from-the-request"><a href="#objects-from-the-request" class="header-anchor">#</a> Objects from the <code>Request</code></h2> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><p>Sometimes you may want to extract details from the request and preprocess them. You could, for example, cast the request JSON to a Python object, and then add some additional logic based upon DB queries.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>If you plan to use this method, you should note that the injection actually happens <em>before</em> Sanic has had a chance to read the request body. The headers should already have been consumed. So, if you do want access to the body, you will need to manually consume as seen in this example.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">await</span> request<span class="token punctuation">.</span>receive_body<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <p>This could be used in cases where you otherwise might:</p> <ul><li>use middleware to preprocess and add something to the <code>request.ctx</code></li> <li>use decorators to preprocess and inject arguments into the request handler</li></ul> <p>In this example, we are using the <code>Request</code> object in the <code>compule_profile</code> constructor to run a fake DB query to generate and return a <code>UserProfile</code> object.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">:</span>
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">UserProfile</span><span class="token punctuation">:</span>
    user<span class="token punctuation">:</span> User
    age<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    email<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__json__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> ujson<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
                <span class="token string">&quot;email&quot;</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">fake_request_to_db</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">:</span>
    today <span class="token operator">=</span> date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>body<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">@something.com'</span></span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    difference <span class="token operator">=</span> today <span class="token operator">-</span> date<span class="token punctuation">.</span>fromisoformat<span class="token punctuation">(</span>body<span class="token punctuation">[</span><span class="token string">&quot;birthday&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    age <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>difference<span class="token punctuation">.</span>days <span class="token operator">/</span> <span class="token number">365</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> UserProfile<span class="token punctuation">(</span>
        User<span class="token punctuation">(</span>body<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token operator">=</span>age<span class="token punctuation">,</span>
        email<span class="token operator">=</span>email<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">compile_profile</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">await</span> request<span class="token punctuation">.</span>receive_body<span class="token punctuation">(</span><span class="token punctuation">)</span>
    profile <span class="token operator">=</span> <span class="token keyword">await</span> fake_request_to_db<span class="token punctuation">(</span>request<span class="token punctuation">.</span>json<span class="token punctuation">)</span>
    <span class="token keyword">return</span> profile
app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>add_dependency<span class="token punctuation">(</span>UserProfile<span class="token punctuation">,</span> compile_profile<span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>patch</span><span class="token punctuation">(</span><span class="token string">&quot;/profile&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">update_profile</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> profile<span class="token punctuation">:</span> UserProfile<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> json<span class="token punctuation">(</span>profile<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>$ curl localhost:8000/profile -X PATCH -d '{&quot;name&quot;: &quot;Alice&quot;, &quot;birthday&quot;: &quot;2000-01-01&quot;}'
{
    &quot;name&quot;:&quot;Alice&quot;,
    &quot;age&quot;:21,
    &quot;email&quot;:&quot;alice@something.com&quot;
}
</code></pre></div></div></div> <h2 id="injecting-services"><a href="#injecting-services" class="header-anchor">#</a> Injecting services</h2> <p>It is a common pattern to create things like database connection pools and store them on the <code>app.ctx</code> object. This makes them available throughout your application, which is certainly a convenience. One downside, however, is that you no longer have a typed object to work with. You can use dependency injections to fix this. First we will show the concept using the lower level <code>add_dependency</code> like we have been using in the previous examples. But, there is a better way using the higher level <code>dependency</code> method.</p> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><h3 id="the-lower-level-api-using-add-dependency"><a href="#the-lower-level-api-using-add-dependency" class="header-anchor">#</a> The lower level API using <code>add_dependency</code></h3> <p>This works very similar to the <a href="#objects-from-the-request">last example</a> where the goal is the extract something from the <code>Request</code> object. In this example, a database object was created on the <code>app.ctx</code> instance, and is being returned in the dependency injection constructor.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">FakeConnection</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> query<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token operator">**</span>arguments<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;result&quot;</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>before_server_start</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">setup_db</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>db_conn <span class="token operator">=</span> FakeConnection<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>add_dependency<span class="token punctuation">(</span>FakeConnection<span class="token punctuation">,</span> get_db<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_db</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span> Request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> request<span class="token punctuation">.</span>app<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>db_conn
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">handler</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> conn<span class="token punctuation">:</span> FakeConnection<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> <span class="token keyword">await</span> conn<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> text<span class="token punctuation">(</span>response<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>$ curl localhost:8000/
result
</code></pre></div></div></div> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><h3 id="the-higher-level-api-using-dependency"><a href="#the-higher-level-api-using-dependency" class="header-anchor">#</a> The higher level API using <code>dependency</code></h3> <p>Since we have an actual <em>object</em> that is available when adding the dependency injection, we can use the higher level <code>dependency</code> method. This will make the pattern much easier to write.</p> <p>This method should always be used when you want to inject something that exists throughout the lifetime of the application instance and is not request specific. It is very useful for services, third party clients, and connection pools since they are not request specific.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">FakeConnection</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> query<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token operator">**</span>arguments<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;result&quot;</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>before_server_start</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">setup_db</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">:</span>
    db_conn <span class="token operator">=</span> FakeConnection<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>dependency<span class="token punctuation">(</span>db_conn<span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">handler</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> conn<span class="token punctuation">:</span> FakeConnection<span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> <span class="token keyword">await</span> conn<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> text<span class="token punctuation">(</span>response<span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>$ curl localhost:8000/
result
</code></pre></div></div></div> <h2 id="generic-types"><a href="#generic-types" class="header-anchor">#</a> Generic types</h2> <p>Be carefule when using a <a href="https://docs.python.org/3/library/typing.html#typing.Generic" target="_blank" rel="noopener noreferrer">generic type<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. The way that Sanic's dependency injection works is by matching the entire type definition. Therefore, <code>Foo</code> is not the same as <code>Foo[str]</code>. This can be particularly tricky when trying to use the <a href="#the-higher-level-api-using-dependency">higher-level <code>dependency</code> method</a> since the type is inferred.</p> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><p>For example, this will <strong>NOT</strong> work as expected since there is no definition for <code>Test[str]</code>.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-python"><code><span class="token keyword">import</span> typing
<span class="token keyword">from</span> sanic <span class="token keyword">import</span> Sanic<span class="token punctuation">,</span> text
T <span class="token operator">=</span> typing<span class="token punctuation">.</span>TypeVar<span class="token punctuation">(</span><span class="token string">&quot;T&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">(</span>typing<span class="token punctuation">.</span>Generic<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    test<span class="token punctuation">:</span> T
app <span class="token operator">=</span> Sanic<span class="token punctuation">(</span><span class="token string">&quot;testapp&quot;</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>dependency<span class="token punctuation">(</span>Test<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> test<span class="token punctuation">:</span> Test<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div></div></div> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><p>To get this example to work, you will need to add an explicit definition for the type you intend to be injected.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-python"><code><span class="token keyword">import</span> typing
<span class="token keyword">from</span> sanic <span class="token keyword">import</span> Sanic<span class="token punctuation">,</span> text
T <span class="token operator">=</span> typing<span class="token punctuation">.</span>TypeVar<span class="token punctuation">(</span><span class="token string">&quot;T&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">(</span>typing<span class="token punctuation">.</span>Generic<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    test<span class="token punctuation">:</span> T
app <span class="token operator">=</span> Sanic<span class="token punctuation">(</span><span class="token string">&quot;testapp&quot;</span><span class="token punctuation">)</span>
_singleton <span class="token operator">=</span> Test<span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>add_dependency<span class="token punctuation">(</span>Test<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> _singleton<span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> test<span class="token punctuation">:</span> Test<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div></div></div> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <div class="multicolumn" style="display:flex;flex-direction:row;align-items:flex-start;"><div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><p>By default, dependencies will be injected after the <code>http.routing.after</code> <a href="/en/guide/advanced/signals.html#built-in-signals">signal</a>. Starting in v22.9, you can change this to the <code>http.handler.before</code> signal.</p></div> <div class="multicolumn-column" style="flex-grow:1;flex-basis:0;"><div class="language-python extra-class"><pre class="language-python"><code>app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>INJECTION_SIGNAL <span class="token operator">=</span> <span class="token string">&quot;http.handler.before&quot;</span>
</code></pre></div></div></div> <p><em>Added in v22.9</em></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/sanic-org/sanic-guide/edit/main/src/en/plugins/sanic-ext/injection.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">Wed, 15 Feb 2023 18:55:28 GMT</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en/plugins/sanic-ext/templating.html" class="prev">
        Templating
      </a></span> <span class="next"><a href="/en/plugins/sanic-ext/validation.html">
        Validation
      </a>
      →
    </span></p></div> </main> <footer class="page-footer"><a href="https://github.com/sanic-org/sanic/blob/master/LICENSE">
    MIT Licensed
  </a> <br>
  Copyright © 2018-present Sanic Community Organization<br> <p>~ Made with ❤️ and ☕️ ~</p></footer></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7fc9e08c.js" defer></script><script src="/assets/js/5.2e6dc6df.js" defer></script><script src="/assets/js/1.1d605411.js" defer></script><script src="/assets/js/103.0f1c399f.js" defer></script>
  </body>
</html>
